2026-01-29T14:59:23.541+01:00  INFO 7288 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 7288 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T14:59:23.541+01:00  INFO 7288 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T14:59:23.588+01:00  INFO 7288 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T14:59:23.588+01:00  INFO 7288 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T14:59:24.123+01:00  INFO 7288 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T14:59:24.154+01:00  INFO 7288 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2026-01-29T14:59:24.858+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T14:59:24.873+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T14:59:24.873+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T14:59:24.905+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T14:59:24.905+01:00  INFO 7288 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1317 ms
2026-01-29T14:59:25.107+01:00  INFO 7288 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T14:59:25.277+01:00  INFO 7288 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T14:59:25.279+01:00  INFO 7288 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T14:59:25.311+01:00  INFO 7288 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T14:59:25.342+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T14:59:25.342+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.019s)
2026-01-29T14:59:25.342+01:00  INFO 7288 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T14:59:25.342+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T14:59:25.374+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T14:59:25.389+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T14:59:25.403+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T14:59:25.456+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T14:59:25.511+01:00  INFO 7288 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T14:59:25.530+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T14:59:25.925+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T14:59:25.999+01:00  INFO 7288 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T14:59:26.217+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T14:59:26.217+01:00  INFO 7288 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T14:59:26.343+01:00  WARN 7288 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T14:59:26.513+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T14:59:26.589+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2026-01-29T14:59:26.671+01:00  INFO 7288 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T14:59:26.686+01:00  INFO 7288 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.71 seconds (process running for 4.066)
2026-01-29T15:00:12.715+01:00  INFO 7288 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:00:12.731+01:00  INFO 7288 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:00:12.754+01:00  INFO 7288 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:00:12.760+01:00  WARN 7288 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:00:12.761+01:00  INFO 7288 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:00:12.763+01:00  INFO 7288 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:00:21.441+01:00  INFO 3904 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 3904 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:00:21.441+01:00  INFO 3904 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:00:21.482+01:00  INFO 3904 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:00:21.482+01:00  INFO 3904 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:00:22.233+01:00  INFO 3904 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:00:22.249+01:00  INFO 3904 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2026-01-29T15:00:22.736+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:00:22.748+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:00:22.748+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:00:22.780+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:00:22.780+01:00  INFO 3904 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1298 ms
2026-01-29T15:00:22.955+01:00  INFO 3904 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:00:23.276+01:00  INFO 3904 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:00:23.276+01:00  INFO 3904 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:00:23.380+01:00  INFO 3904 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:00:23.405+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:00:23.405+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.010s)
2026-01-29T15:00:23.405+01:00  INFO 3904 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:00:23.405+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:00:23.436+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:00:23.436+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:00:23.452+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.008s)
2026-01-29T15:00:23.514+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:00:23.561+01:00  INFO 3904 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:00:23.592+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:00:23.780+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:00:23.842+01:00  INFO 3904 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:00:24.076+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:00:24.076+01:00  INFO 3904 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:00:24.248+01:00  WARN 3904 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:00:24.614+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:00:24.654+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2026-01-29T15:00:24.733+01:00  INFO 3904 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:00:24.733+01:00  INFO 3904 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.688 seconds (process running for 4.238)
2026-01-29T15:01:06.444+01:00  INFO 3904 --- [Api Gateway] [http-nio-8080-exec-5] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T15:01:06.446+01:00  INFO 3904 --- [Api Gateway] [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T15:01:06.448+01:00  INFO 3904 --- [Api Gateway] [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2026-01-29T15:01:33.365+01:00  INFO 3904 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:01:33.400+01:00  INFO 3904 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:01:33.415+01:00  INFO 3904 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:01:33.415+01:00  WARN 3904 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:01:33.415+01:00  INFO 3904 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:01:33.415+01:00  INFO 3904 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:01:40.251+01:00  INFO 7596 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 7596 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:01:40.251+01:00  INFO 7596 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:01:40.279+01:00  INFO 7596 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:01:40.279+01:00  INFO 7596 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:01:40.796+01:00  INFO 7596 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:01:40.843+01:00  INFO 7596 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 0 JPA repository interfaces.
2026-01-29T15:01:41.401+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:01:41.412+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:01:41.413+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:01:41.436+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:01:41.451+01:00  INFO 7596 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1167 ms
2026-01-29T15:01:41.607+01:00  INFO 7596 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:01:41.729+01:00  INFO 7596 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:01:41.731+01:00  INFO 7596 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:01:41.764+01:00  INFO 7596 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:01:41.779+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:01:41.779+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.009s)
2026-01-29T15:01:41.779+01:00  INFO 7596 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:01:41.779+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:01:41.817+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:01:41.822+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:01:41.834+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.005s)
2026-01-29T15:01:41.910+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:01:41.947+01:00  INFO 7596 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:01:41.976+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:01:42.169+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:01:42.202+01:00  INFO 7596 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:01:42.420+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:01:42.420+01:00  INFO 7596 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:01:42.626+01:00  WARN 7596 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:01:42.780+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:01:42.835+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2026-01-29T15:01:42.888+01:00  INFO 7596 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:01:42.888+01:00  INFO 7596 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.106 seconds (process running for 3.532)
2026-01-29T15:08:41.108+01:00  INFO 7596 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:08:41.190+01:00  INFO 7596 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:08:41.248+01:00  INFO 7596 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:08:41.249+01:00  WARN 7596 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:08:41.249+01:00  INFO 7596 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:08:41.249+01:00  INFO 7596 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:08:52.124+01:00  INFO 2616 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 2616 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:08:52.124+01:00  INFO 2616 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:08:52.166+01:00  INFO 2616 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:08:52.167+01:00  INFO 2616 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:08:52.810+01:00  INFO 2616 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:08:52.841+01:00  INFO 2616 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2026-01-29T15:08:53.452+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:08:53.472+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:08:53.473+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:08:53.498+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:08:53.498+01:00  INFO 2616 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1331 ms
2026-01-29T15:08:53.671+01:00  INFO 2616 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:08:53.827+01:00  INFO 2616 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:08:53.827+01:00  INFO 2616 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:08:53.890+01:00  INFO 2616 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:08:53.937+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:08:53.952+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.020s)
2026-01-29T15:08:53.952+01:00  INFO 2616 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:08:53.968+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:08:53.987+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:08:53.987+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:08:54.002+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T15:08:54.061+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:08:54.108+01:00  INFO 2616 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:08:54.140+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:08:54.452+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:08:54.514+01:00  INFO 2616 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:08:54.733+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:08:54.748+01:00  INFO 2616 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:08:54.842+01:00  WARN 2616 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:08:55.014+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:08:55.186+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2026-01-29T15:08:55.416+01:00  INFO 2616 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:08:55.433+01:00  INFO 2616 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.792 seconds (process running for 4.23)
2026-01-29T15:08:59.842+01:00  INFO 2616 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:08:59.891+01:00  INFO 2616 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:08:59.904+01:00  INFO 2616 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:08:59.904+01:00  WARN 2616 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:08:59.904+01:00  INFO 2616 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:08:59.904+01:00  INFO 2616 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:22:55.150+01:00  INFO 7200 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 7200 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:22:55.150+01:00  INFO 7200 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:22:55.195+01:00  INFO 7200 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:22:55.195+01:00  INFO 7200 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:22:55.944+01:00  INFO 7200 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:22:55.970+01:00  INFO 7200 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 12 ms. Found 0 JPA repository interfaces.
2026-01-29T15:22:56.784+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:22:56.796+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:22:56.797+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:22:56.827+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:22:56.827+01:00  INFO 7200 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1632 ms
2026-01-29T15:22:57.140+01:00  INFO 7200 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:22:57.311+01:00  INFO 7200 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:22:57.326+01:00  INFO 7200 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:22:57.358+01:00  INFO 7200 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:22:57.374+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:22:57.374+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.010s)
2026-01-29T15:22:57.389+01:00  INFO 7200 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:22:57.389+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:22:57.405+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:22:57.421+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:22:57.441+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T15:22:57.507+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:22:57.546+01:00  INFO 7200 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:22:57.577+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:22:57.860+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:22:57.921+01:00  INFO 7200 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:22:58.735+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:22:58.756+01:00  INFO 7200 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:22:58.875+01:00  WARN 7200 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:22:59.209+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:22:59.264+01:00  WARN 7200 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T15:22:59.343+01:00  INFO 7200 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:22:59.390+01:00  INFO 7200 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.745 seconds (process running for 5.128)
2026-01-29T15:27:59.441+01:00  INFO 7200 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:27:59.484+01:00  INFO 7200 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:27:59.501+01:00  INFO 7200 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:27:59.516+01:00  WARN 7200 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:27:59.516+01:00  INFO 7200 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:27:59.516+01:00  INFO 7200 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:28:19.379+01:00  INFO 14920 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 14920 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:28:19.386+01:00  INFO 14920 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:28:19.410+01:00  INFO 14920 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:28:19.410+01:00  INFO 14920 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:28:19.951+01:00  INFO 14920 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:28:19.984+01:00  INFO 14920 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 12 ms. Found 0 JPA repository interfaces.
2026-01-29T15:28:21.045+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:28:21.085+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:28:21.087+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:28:21.167+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:28:21.170+01:00  INFO 14920 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1759 ms
2026-01-29T15:28:21.660+01:00  INFO 14920 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:28:21.870+01:00  INFO 14920 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:28:21.872+01:00  INFO 14920 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:28:21.917+01:00  INFO 14920 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:28:21.950+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:28:21.955+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.021s)
2026-01-29T15:28:21.965+01:00  INFO 14920 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:28:21.969+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:28:22.016+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:28:22.029+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:28:22.060+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.011s)
2026-01-29T15:28:22.169+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:28:22.234+01:00  INFO 14920 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:28:22.287+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:28:22.748+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:28:22.813+01:00  INFO 14920 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:28:23.084+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:28:23.085+01:00  INFO 14920 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:28:23.206+01:00  WARN 14920 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:28:23.401+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:28:23.497+01:00  WARN 14920 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T15:28:23.568+01:00  INFO 14920 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:28:23.579+01:00  INFO 14920 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.715 seconds (process running for 5.402)
2026-01-29T15:28:25.777+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T15:28:25.778+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T15:28:25.783+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2026-01-29T15:28:26.120+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:28:26.120+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:28:26.136+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:28:29.325+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 6
2026-01-29T15:28:29.326+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 6
2026-01-29T15:28:29.329+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:28:30.730+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 6
2026-01-29T15:28:30.731+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Payment created with ID: 6 and transaction ID: TXN-c5fbd62e-65c6-4c28-843f-69d7707b546d
2026-01-29T15:28:30.731+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:28:31.765+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 6
2026-01-29T15:28:31.765+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Shipment created with ID: 6
2026-01-29T15:28:31.765+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 6
2026-01-29T15:28:31.765+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=5644 ms | success=true
2026-01-29T15:28:42.148+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:28:42.153+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:28:42.156+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : PHASE 1: PREPARE
2026-01-29T15:28:42.156+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:28:42.156+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:28:42.215+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 7
2026-01-29T15:28:42.215+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=7, status=PREPARED
2026-01-29T15:28:42.215+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:28:42.215+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:28:42.247+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 7
2026-01-29T15:28:42.248+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=7, status=PRE_AUTHORIZED
2026-01-29T15:28:42.248+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:28:42.248+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:28:42.286+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 7
2026-01-29T15:28:42.287+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=7, status=RESERVED
2026-01-29T15:28:42.288+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:28:42.288+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : All participants voted READY
2026-01-29T15:28:42.288+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : PHASE 2: COMMIT
2026-01-29T15:28:42.288+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:28:42.288+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/7/commit
2026-01-29T15:28:42.321+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 7
2026-01-29T15:28:42.321+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=7
2026-01-29T15:28:42.321+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:28:42.321+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/7/commit
2026-01-29T15:28:42.358+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 7
2026-01-29T15:28:42.358+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=7
2026-01-29T15:28:42.361+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:28:42.363+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/7/commit
2026-01-29T15:28:42.405+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 7
2026-01-29T15:28:42.405+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=7
2026-01-29T15:28:42.405+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:28:42.405+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : 2PC completed successfully - Order ID: 7
2026-01-29T15:28:42.405+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=254 ms | success=true
2026-01-29T15:28:44.401+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:28:44.401+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:28:44.401+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : PHASE 1: PREPARE
2026-01-29T15:28:44.401+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:28:44.401+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:28:44.487+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 8
2026-01-29T15:28:44.487+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=8, status=PREPARED
2026-01-29T15:28:44.487+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:28:44.487+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:28:44.604+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 8
2026-01-29T15:28:44.604+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=8, status=PRE_AUTHORIZED
2026-01-29T15:28:44.604+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:28:44.604+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 8
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=8, status=RESERVED
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : All participants voted READY
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : PHASE 2: COMMIT
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:28:44.651+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/8/commit
2026-01-29T15:28:44.671+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 8
2026-01-29T15:28:44.671+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=8
2026-01-29T15:28:44.671+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:28:44.671+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/8/commit
2026-01-29T15:28:44.686+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 8
2026-01-29T15:28:44.686+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=8
2026-01-29T15:28:44.686+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:28:44.686+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/8/commit
2026-01-29T15:28:44.702+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 8
2026-01-29T15:28:44.702+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=8
2026-01-29T15:28:44.702+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:28:44.702+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : 2PC completed successfully - Order ID: 8
2026-01-29T15:28:44.702+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=300 ms | success=true
2026-01-29T15:28:46.843+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:28:46.844+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:28:46.844+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:28:46.904+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 9
2026-01-29T15:28:46.904+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Order created with ID: 9
2026-01-29T15:28:46.904+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:28:46.946+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 9
2026-01-29T15:28:46.946+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Payment created with ID: 9 and transaction ID: TXN-ba0be18e-d927-4438-aeed-5868a6d47e5e
2026-01-29T15:28:46.948+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:28:46.983+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 9
2026-01-29T15:28:46.983+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Shipment created with ID: 9
2026-01-29T15:28:46.983+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 9
2026-01-29T15:28:46.983+01:00  INFO 14920 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=141 ms | success=true
2026-01-29T15:30:25.060+01:00  INFO 14920 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:30:25.107+01:00  INFO 14920 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:30:25.154+01:00  INFO 14920 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:30:25.154+01:00  WARN 14920 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:30:25.154+01:00  INFO 14920 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:30:25.170+01:00  INFO 14920 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:32:15.960+01:00  INFO 10404 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 10404 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:32:15.960+01:00  INFO 10404 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:32:15.995+01:00  INFO 10404 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:32:15.995+01:00  INFO 10404 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:32:16.482+01:00  INFO 10404 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:32:16.514+01:00  INFO 10404 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2026-01-29T15:32:17.220+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:32:17.232+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:32:17.233+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:32:17.263+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:32:17.263+01:00  INFO 10404 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1268 ms
2026-01-29T15:32:17.455+01:00  INFO 10404 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:32:17.624+01:00  INFO 10404 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:32:17.624+01:00  INFO 10404 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:32:17.655+01:00  INFO 10404 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:32:17.686+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:32:17.686+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.011s)
2026-01-29T15:32:17.686+01:00  INFO 10404 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:32:17.686+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:32:17.717+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:32:17.717+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:32:17.740+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T15:32:17.804+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:32:17.916+01:00  INFO 10404 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:32:18.134+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:32:18.483+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:32:18.607+01:00  INFO 10404 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:32:18.984+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:32:18.984+01:00  INFO 10404 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:32:19.108+01:00  WARN 10404 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:32:19.495+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:32:19.562+01:00  WARN 10404 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T15:32:19.638+01:00  INFO 10404 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:32:19.651+01:00  INFO 10404 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.145 seconds (process running for 4.46)
2026-01-29T15:32:25.844+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T15:32:25.852+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T15:32:25.855+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2026-01-29T15:32:26.100+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:32:26.101+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:32:26.104+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:32:26.105+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:32:26.189+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 10
2026-01-29T15:32:26.189+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=10, status=PREPARED
2026-01-29T15:32:26.205+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:32:26.207+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:32:26.233+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 10
2026-01-29T15:32:26.233+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=10, status=PRE_AUTHORIZED
2026-01-29T15:32:26.233+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:32:26.233+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:32:26.274+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 10
2026-01-29T15:32:26.274+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=10, status=RESERVED
2026-01-29T15:32:26.274+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:32:26.274+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:32:26.274+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/10/commit
2026-01-29T15:32:26.301+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 10
2026-01-29T15:32:26.301+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=10
2026-01-29T15:32:26.301+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:32:26.301+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/10/commit
2026-01-29T15:32:26.316+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 10
2026-01-29T15:32:26.316+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=10
2026-01-29T15:32:26.316+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:32:26.316+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/10/commit
2026-01-29T15:32:26.352+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 10
2026-01-29T15:32:26.352+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=10
2026-01-29T15:32:26.352+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:32:26.352+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=265 ms | success=true
2026-01-29T15:32:30.067+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:32:30.067+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:32:30.091+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:32:30.185+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 11
2026-01-29T15:32:30.186+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order created with ID: 11
2026-01-29T15:32:30.186+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:32:30.208+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 11
2026-01-29T15:32:30.208+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Payment created with ID: 11 and transaction ID: TXN-ac17f476-d0eb-4e75-bddb-c18c9c97941f
2026-01-29T15:32:30.208+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:32:30.239+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 11
2026-01-29T15:32:30.240+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Shipment created with ID: 11
2026-01-29T15:32:30.240+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 11
2026-01-29T15:32:30.240+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=166 ms | success=true
2026-01-29T15:32:31.938+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:32:31.939+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:32:31.939+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:32:31.939+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:32:31.996+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 12
2026-01-29T15:32:31.996+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=12, status=PREPARED
2026-01-29T15:32:31.996+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:32:31.996+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:32:32.031+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 12
2026-01-29T15:32:32.032+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=12, status=PRE_AUTHORIZED
2026-01-29T15:32:32.032+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:32:32.032+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:32:32.076+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 12
2026-01-29T15:32:32.076+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=12, status=RESERVED
2026-01-29T15:32:32.078+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:32:32.078+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:32:32.079+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/12/commit
2026-01-29T15:32:32.096+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 12
2026-01-29T15:32:32.096+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=12
2026-01-29T15:32:32.096+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:32:32.096+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/12/commit
2026-01-29T15:32:32.113+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 12
2026-01-29T15:32:32.113+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=12
2026-01-29T15:32:32.113+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:32:32.113+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/12/commit
2026-01-29T15:32:32.130+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 12
2026-01-29T15:32:32.130+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=12
2026-01-29T15:32:32.130+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:32:32.130+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=194 ms | success=true
2026-01-29T15:32:35.739+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:32:35.739+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:32:35.741+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:32:35.807+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 13
2026-01-29T15:32:35.815+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order created with ID: 13
2026-01-29T15:32:35.815+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:32:35.855+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 13
2026-01-29T15:32:35.855+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Payment created with ID: 13 and transaction ID: TXN-32bb93bd-418b-4053-9772-d88273309870
2026-01-29T15:32:35.858+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:32:35.940+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 13
2026-01-29T15:32:35.940+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Shipment created with ID: 13
2026-01-29T15:32:35.940+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 13
2026-01-29T15:32:35.940+01:00  INFO 10404 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=207 ms | success=true
2026-01-29T15:32:40.499+01:00  INFO 10404 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:32:40.515+01:00  INFO 10404 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:32:40.546+01:00  INFO 10404 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:32:40.561+01:00  WARN 10404 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:32:40.561+01:00  INFO 10404 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:32:40.561+01:00  INFO 10404 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:33:18.803+01:00  INFO 3556 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 3556 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:33:18.804+01:00  INFO 3556 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:33:18.861+01:00  INFO 3556 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:33:18.861+01:00  INFO 3556 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:33:19.638+01:00  INFO 3556 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:33:19.654+01:00  INFO 3556 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 0 JPA repository interfaces.
2026-01-29T15:33:20.129+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:33:20.129+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:33:20.129+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:33:20.170+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:33:20.170+01:00  INFO 3556 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1309 ms
2026-01-29T15:33:20.385+01:00  INFO 3556 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:33:21.019+01:00  INFO 3556 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:33:21.034+01:00  INFO 3556 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:33:21.107+01:00  INFO 3556 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:33:21.146+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:33:21.151+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.020s)
2026-01-29T15:33:21.159+01:00  INFO 3556 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:33:21.162+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:33:21.191+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:33:21.196+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:33:21.211+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T15:33:21.264+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:33:21.326+01:00  INFO 3556 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:33:21.373+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:33:21.545+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:33:21.615+01:00  INFO 3556 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:33:22.046+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:33:22.046+01:00  INFO 3556 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:33:22.163+01:00  WARN 3556 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:33:22.315+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:33:22.373+01:00  WARN 3556 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T15:33:22.459+01:00  INFO 3556 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:33:22.467+01:00  INFO 3556 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.032 seconds (process running for 4.532)
2026-01-29T15:33:25.164+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T15:33:25.165+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T15:33:25.167+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2026-01-29T15:33:25.531+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:33:25.532+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:33:25.547+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:33:25.548+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:33:25.654+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 14
2026-01-29T15:33:25.655+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=14, status=PREPARED
2026-01-29T15:33:25.656+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:33:25.658+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:33:25.684+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 14
2026-01-29T15:33:25.685+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=14, status=PRE_AUTHORIZED
2026-01-29T15:33:25.685+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:33:25.690+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:33:25.723+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 14
2026-01-29T15:33:25.723+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=14, status=RESERVED
2026-01-29T15:33:25.724+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:33:25.724+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:33:25.725+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/14/commit
2026-01-29T15:33:25.747+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 14
2026-01-29T15:33:25.747+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=14
2026-01-29T15:33:25.748+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:33:25.748+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/14/commit
2026-01-29T15:33:25.761+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 14
2026-01-29T15:33:25.761+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=14
2026-01-29T15:33:25.762+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:33:25.762+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/14/commit
2026-01-29T15:33:25.777+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 14
2026-01-29T15:33:25.777+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=14
2026-01-29T15:33:25.778+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:33:25.780+01:00  INFO 3556 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=247 ms | success=true
2026-01-29T15:56:56.498+01:00  INFO 3556 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T15:56:56.514+01:00  INFO 3556 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T15:56:56.585+01:00  INFO 3556 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:56:56.594+01:00  WARN 3556 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T15:56:56.595+01:00  INFO 3556 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T15:56:56.597+01:00  INFO 3556 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T15:58:08.383+01:00  INFO 16232 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 16232 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T15:58:08.385+01:00  INFO 16232 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T15:58:08.413+01:00  INFO 16232 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T15:58:08.413+01:00  INFO 16232 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T15:58:09.216+01:00  INFO 16232 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T15:58:09.248+01:00  INFO 16232 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2026-01-29T15:58:09.799+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T15:58:09.825+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T15:58:09.825+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T15:58:09.890+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T15:58:09.890+01:00  INFO 16232 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1477 ms
2026-01-29T15:58:10.213+01:00  INFO 16232 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T15:58:10.385+01:00  INFO 16232 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T15:58:10.387+01:00  INFO 16232 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T15:58:10.420+01:00  INFO 16232 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T15:58:10.435+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T15:58:10.435+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.010s)
2026-01-29T15:58:10.451+01:00  INFO 16232 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T15:58:10.451+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T15:58:10.467+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T15:58:10.482+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T15:58:10.501+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T15:58:10.567+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T15:58:10.655+01:00  INFO 16232 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T15:58:10.687+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T15:58:10.967+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T15:58:11.108+01:00  INFO 16232 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T15:58:11.405+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T15:58:11.405+01:00  INFO 16232 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T15:58:11.514+01:00  WARN 16232 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T15:58:11.670+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T15:58:11.733+01:00  WARN 16232 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T15:58:11.796+01:00  INFO 16232 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T15:58:11.796+01:00  INFO 16232 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.796 seconds (process running for 4.167)
2026-01-29T15:58:25.123+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T15:58:25.123+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T15:58:25.123+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2026-01-29T15:58:25.316+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:58:25.316+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:58:25.318+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:58:25.855+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 15
2026-01-29T15:58:25.855+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 15
2026-01-29T15:58:25.855+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:58:26.366+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 15
2026-01-29T15:58:26.367+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Payment created with ID: 15 and transaction ID: TXN-dfa30f85-f261-4087-852f-07f4a878a868
2026-01-29T15:58:26.368+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:58:26.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 15
2026-01-29T15:58:26.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Shipment created with ID: 15
2026-01-29T15:58:26.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 15
2026-01-29T15:58:26.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=1602 ms | success=true
2026-01-29T15:58:29.165+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:58:29.165+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:58:29.173+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:58:29.173+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:58:29.231+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 16
2026-01-29T15:58:29.231+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=16, status=PREPARED, latency=58ms
2026-01-29T15:58:29.231+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:58:29.231+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:58:29.263+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 16
2026-01-29T15:58:29.264+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=16, status=PRE_AUTHORIZED, latency=33ms
2026-01-29T15:58:29.265+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:58:29.267+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:58:29.307+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 16
2026-01-29T15:58:29.307+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=16, status=RESERVED, latency=42ms
2026-01-29T15:58:29.307+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:58:29.307+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:58:29.314+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/16/commit
2026-01-29T15:58:29.340+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 16
2026-01-29T15:58:29.340+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=16, latency=33ms
2026-01-29T15:58:29.340+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:58:29.340+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/16/commit
2026-01-29T15:58:29.367+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 16
2026-01-29T15:58:29.368+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=16, latency=28ms
2026-01-29T15:58:29.369+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:58:29.369+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/16/commit
2026-01-29T15:58:29.398+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 16
2026-01-29T15:58:29.398+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=16, latency=29ms
2026-01-29T15:58:29.398+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:58:29.398+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=233 ms | success=true
2026-01-29T15:58:32.560+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:58:32.561+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:58:32.562+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:58:32.562+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:58:32.680+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 17
2026-01-29T15:58:32.680+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=17, status=PREPARED, latency=118ms
2026-01-29T15:58:32.680+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:58:32.680+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:58:32.711+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 17
2026-01-29T15:58:32.711+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=17, status=PRE_AUTHORIZED, latency=31ms
2026-01-29T15:58:32.711+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:58:32.711+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:58:32.749+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 17
2026-01-29T15:58:32.749+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=17, status=RESERVED, latency=38ms
2026-01-29T15:58:32.749+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:58:32.749+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:58:32.749+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/17/commit
2026-01-29T15:58:32.764+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 17
2026-01-29T15:58:32.764+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=17, latency=15ms
2026-01-29T15:58:32.764+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:58:32.764+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/17/commit
2026-01-29T15:58:32.779+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 17
2026-01-29T15:58:32.779+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=17, latency=15ms
2026-01-29T15:58:32.779+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:58:32.779+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/17/commit
2026-01-29T15:58:32.807+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 17
2026-01-29T15:58:32.807+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=17, latency=28ms
2026-01-29T15:58:32.808+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:58:32.808+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=246 ms | success=true
2026-01-29T15:59:02.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:59:02.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:59:02.506+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:59:02.506+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:59:02.584+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 18
2026-01-29T15:59:02.585+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=18, status=PREPARED, latency=79ms
2026-01-29T15:59:02.586+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:59:02.586+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:59:02.622+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 18
2026-01-29T15:59:02.622+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=18, status=PRE_AUTHORIZED, latency=36ms
2026-01-29T15:59:02.623+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:59:02.624+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:59:02.729+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 18
2026-01-29T15:59:02.734+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=18, status=RESERVED, latency=111ms
2026-01-29T15:59:02.736+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:59:02.736+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:59:02.742+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/18/commit
2026-01-29T15:59:02.794+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 18
2026-01-29T15:59:02.795+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=18, latency=59ms
2026-01-29T15:59:02.796+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:59:02.796+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/18/commit
2026-01-29T15:59:02.825+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 18
2026-01-29T15:59:02.826+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=18, latency=30ms
2026-01-29T15:59:02.826+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:59:02.826+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/18/commit
2026-01-29T15:59:02.841+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 18
2026-01-29T15:59:02.841+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=18, latency=15ms
2026-01-29T15:59:02.842+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:59:02.842+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=337 ms | success=true
2026-01-29T15:59:04.887+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:59:04.888+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:59:04.888+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:59:04.888+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:59:04.942+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 19
2026-01-29T15:59:04.944+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=19, status=PREPARED, latency=56ms
2026-01-29T15:59:04.946+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:59:04.946+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:59:04.972+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 19
2026-01-29T15:59:04.972+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=19, status=PRE_AUTHORIZED, latency=27ms
2026-01-29T15:59:04.972+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:59:04.977+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:59:05.101+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 19
2026-01-29T15:59:05.102+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=19, status=RESERVED, latency=129ms
2026-01-29T15:59:05.103+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:59:05.104+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:59:05.105+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/19/commit
2026-01-29T15:59:05.170+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 19
2026-01-29T15:59:05.170+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=19, latency=66ms
2026-01-29T15:59:05.170+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:59:05.170+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/19/commit
2026-01-29T15:59:05.188+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 19
2026-01-29T15:59:05.188+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=19, latency=18ms
2026-01-29T15:59:05.189+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:59:05.189+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/19/commit
2026-01-29T15:59:05.205+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 19
2026-01-29T15:59:05.206+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=19, latency=17ms
2026-01-29T15:59:05.206+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:59:05.206+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=319 ms | success=true
2026-01-29T15:59:07.533+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:59:07.533+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:59:07.538+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:59:07.592+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 20
2026-01-29T15:59:07.592+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.service.SagaService        : Order created with ID: 20
2026-01-29T15:59:07.593+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:59:07.614+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 20
2026-01-29T15:59:07.614+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.service.SagaService        : Payment created with ID: 20 and transaction ID: TXN-8ba6513b-ac99-41f8-ade3-9bfa3362caa8
2026-01-29T15:59:07.614+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:59:07.647+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 20
2026-01-29T15:59:07.647+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.service.SagaService        : Shipment created with ID: 20
2026-01-29T15:59:07.654+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 20
2026-01-29T15:59:07.658+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=123 ms | success=true
2026-01-29T15:59:09.919+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T15:59:09.919+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T15:59:09.919+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T15:59:09.985+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 21
2026-01-29T15:59:09.985+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order created with ID: 21
2026-01-29T15:59:09.985+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T15:59:10.026+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 21
2026-01-29T15:59:10.026+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Payment created with ID: 21 and transaction ID: TXN-82b722bb-9848-4e8c-8cfd-116ae23b30a6
2026-01-29T15:59:10.026+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T15:59:10.052+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 21
2026-01-29T15:59:10.058+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Shipment created with ID: 21
2026-01-29T15:59:10.059+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 21
2026-01-29T15:59:10.059+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=137 ms | success=true
2026-01-29T15:59:13.341+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T15:59:13.349+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T15:59:13.352+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T15:59:13.352+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T15:59:13.422+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 22
2026-01-29T15:59:13.422+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=22, status=PREPARED, latency=70ms
2026-01-29T15:59:13.430+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T15:59:13.430+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T15:59:13.455+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 22
2026-01-29T15:59:13.455+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=22, status=PRE_AUTHORIZED, latency=25ms
2026-01-29T15:59:13.455+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T15:59:13.455+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T15:59:13.496+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 22
2026-01-29T15:59:13.497+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=22, status=RESERVED, latency=42ms
2026-01-29T15:59:13.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T15:59:13.499+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T15:59:13.499+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/22/commit
2026-01-29T15:59:13.516+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 22
2026-01-29T15:59:13.517+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=22, latency=18ms
2026-01-29T15:59:13.517+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T15:59:13.517+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/22/commit
2026-01-29T15:59:13.540+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 22
2026-01-29T15:59:13.540+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=22, latency=23ms
2026-01-29T15:59:13.540+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T15:59:13.540+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/22/commit
2026-01-29T15:59:13.564+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 22
2026-01-29T15:59:13.564+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=22, latency=24ms
2026-01-29T15:59:13.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T15:59:13.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=216 ms | success=true
2026-01-29T16:01:08.926+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:01:08.928+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:01:08.936+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:01:08.993+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 23
2026-01-29T16:01:08.993+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order created with ID: 23
2026-01-29T16:01:08.993+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:01:09.035+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 23
2026-01-29T16:01:09.035+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Payment created with ID: 23 and transaction ID: TXN-9afe86d4-7d02-487b-a317-e137190b5656
2026-01-29T16:01:09.042+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:01:09.070+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 23
2026-01-29T16:01:09.070+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Shipment created with ID: 23
2026-01-29T16:01:09.070+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 23
2026-01-29T16:01:09.070+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=143 ms | success=true
2026-01-29T16:01:10.873+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:01:10.874+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:01:10.875+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:01:10.931+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 24
2026-01-29T16:01:10.931+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Order created with ID: 24
2026-01-29T16:01:10.931+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:01:10.957+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 24
2026-01-29T16:01:10.957+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Payment created with ID: 24 and transaction ID: TXN-2a259282-121f-447d-9e10-a58eb0c749ac
2026-01-29T16:01:10.963+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:01:10.998+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 24
2026-01-29T16:01:10.999+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Shipment created with ID: 24
2026-01-29T16:01:10.999+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 24
2026-01-29T16:01:10.999+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=127 ms | success=true
2026-01-29T16:01:13.101+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:01:13.101+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:01:13.101+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:01:13.101+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:01:13.167+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 25
2026-01-29T16:01:13.167+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=25, status=PREPARED, latency=66ms
2026-01-29T16:01:13.167+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:01:13.167+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:01:13.200+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 25
2026-01-29T16:01:13.200+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=25, status=PRE_AUTHORIZED, latency=33ms
2026-01-29T16:01:13.208+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:01:13.209+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:01:13.259+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 25
2026-01-29T16:01:13.259+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=25, status=RESERVED, latency=51ms
2026-01-29T16:01:13.268+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:01:13.269+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:01:13.269+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/25/commit
2026-01-29T16:01:13.289+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 25
2026-01-29T16:01:13.289+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=25, latency=20ms
2026-01-29T16:01:13.293+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:01:13.293+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/25/commit
2026-01-29T16:01:13.309+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 25
2026-01-29T16:01:13.309+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=25, latency=16ms
2026-01-29T16:01:13.309+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:01:13.309+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/25/commit
2026-01-29T16:01:13.342+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 25
2026-01-29T16:01:13.342+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=25, latency=33ms
2026-01-29T16:01:13.342+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:01:13.342+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=240 ms | success=true
2026-01-29T16:01:14.676+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:01:14.676+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:01:14.676+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:01:14.682+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:01:14.748+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 26
2026-01-29T16:01:14.750+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=26, status=PREPARED, latency=74ms
2026-01-29T16:01:14.755+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:01:14.755+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:01:14.828+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 26
2026-01-29T16:01:14.844+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=26, status=PRE_AUTHORIZED, latency=89ms
2026-01-29T16:01:14.844+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:01:14.844+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:01:14.950+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 26
2026-01-29T16:01:14.950+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=26, status=RESERVED, latency=106ms
2026-01-29T16:01:14.950+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:01:14.950+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:01:14.950+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/26/commit
2026-01-29T16:01:14.966+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 26
2026-01-29T16:01:14.966+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=26, latency=16ms
2026-01-29T16:01:14.966+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:01:14.966+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/26/commit
2026-01-29T16:01:14.987+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 26
2026-01-29T16:01:15.000+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=26, latency=34ms
2026-01-29T16:01:15.003+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:01:15.004+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/26/commit
2026-01-29T16:01:15.063+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 26
2026-01-29T16:01:15.063+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=26, latency=60ms
2026-01-29T16:01:15.064+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:01:15.064+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=383 ms | success=true
2026-01-29T16:01:16.341+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:01:16.341+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:01:16.341+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:01:16.341+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:01:16.403+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 27
2026-01-29T16:01:16.403+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=27, status=PREPARED, latency=62ms
2026-01-29T16:01:16.404+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:01:16.404+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:01:16.435+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 27
2026-01-29T16:01:16.435+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=27, status=PRE_AUTHORIZED, latency=31ms
2026-01-29T16:01:16.435+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:01:16.435+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:01:16.470+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 27
2026-01-29T16:01:16.470+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=27, status=RESERVED, latency=35ms
2026-01-29T16:01:16.470+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:01:16.470+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:01:16.470+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/27/commit
2026-01-29T16:01:16.484+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 27
2026-01-29T16:01:16.484+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=27, latency=14ms
2026-01-29T16:01:16.484+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:01:16.485+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/27/commit
2026-01-29T16:01:16.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 27
2026-01-29T16:01:16.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=27, latency=14ms
2026-01-29T16:01:16.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:01:16.498+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/27/commit
2026-01-29T16:01:16.514+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 27
2026-01-29T16:01:16.514+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=27, latency=16ms
2026-01-29T16:01:16.514+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:01:16.515+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=170 ms | success=true
2026-01-29T16:01:18.375+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:01:18.376+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:01:18.381+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:01:18.383+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:01:18.524+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 28
2026-01-29T16:01:18.524+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=28, status=PREPARED, latency=143ms
2026-01-29T16:01:18.524+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:01:18.533+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:01:18.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 28
2026-01-29T16:01:18.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=28, status=PRE_AUTHORIZED, latency=42ms
2026-01-29T16:01:18.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:01:18.566+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:01:18.714+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 28
2026-01-29T16:01:18.715+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=28, status=RESERVED, latency=149ms
2026-01-29T16:01:18.716+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:01:18.716+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:01:18.717+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/28/commit
2026-01-29T16:01:18.761+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 28
2026-01-29T16:01:18.762+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=28, latency=46ms
2026-01-29T16:01:18.772+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:01:18.777+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/28/commit
2026-01-29T16:01:18.803+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 28
2026-01-29T16:01:18.803+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=28, latency=31ms
2026-01-29T16:01:18.805+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:01:18.805+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/28/commit
2026-01-29T16:01:18.820+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 28
2026-01-29T16:01:18.821+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=28, latency=16ms
2026-01-29T16:01:18.821+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:01:18.821+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=445 ms | success=true
2026-01-29T16:08:18.244+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:08:18.245+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:08:18.247+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:08:18.644+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 6
2026-01-29T16:08:18.644+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 6
2026-01-29T16:08:18.645+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:08:18.861+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 6","timestamp":"2026-01-29T16:08:18.7561955","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 6","timestamp":"2026-01-29T16:08:18.7561955","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:08:18.881+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 6","timestamp":"2026-01-29T16:08:18.7561955","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 6","timestamp":"2026-01-29T16:08:18.7561955","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 6","timestamp":"2026-01-29T16:08:18.7561955","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:08:18.888+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 6
2026-01-29T16:08:18.986+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=740 ms | success=false
2026-01-29T16:08:22.187+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:08:22.187+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:08:22.187+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:08:22.325+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 7
2026-01-29T16:08:22.326+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 7
2026-01-29T16:08:22.326+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:08:22.345+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 7","timestamp":"2026-01-29T16:08:22.3431148","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 7","timestamp":"2026-01-29T16:08:22.3431148","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:08:22.345+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 7","timestamp":"2026-01-29T16:08:22.3431148","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 7","timestamp":"2026-01-29T16:08:22.3431148","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 7","timestamp":"2026-01-29T16:08:22.3431148","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:08:22.355+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 7
2026-01-29T16:08:22.395+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=206 ms | success=false
2026-01-29T16:08:23.198+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:08:23.203+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:08:23.205+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:08:23.205+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:08:23.305+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 8
2026-01-29T16:08:23.305+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=8, status=PREPARED, latency=100ms
2026-01-29T16:08:23.306+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:08:23.307+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:08:23.445+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: could not execute statement [Unique index or primary key violation: \"PUBLIC.CONSTRAINT_INDEX_8 ON PUBLIC.PAYMENTS(ORDER_ID NULLS FIRST) VALUES ( /* 8 */ CAST(8 AS BIGINT) )\"; SQL statement:\ninsert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default) [23505-232]] [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; SQL [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; constraint [PUBLIC.CONSTRAINT_INDEX_8]","timestamp":"2026-01-29T16:08:23.4459719","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: could not execute statement [Unique index or primary key violation: \"PUBLIC.CONSTRAINT_INDEX_8 ON PUBLIC.PAYMENTS(ORDER_ID NULLS FIRST) VALUES ( /* 8 */ CAST(8 AS BIGINT) )\"; SQL statement:\ninsert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default) [23505-232]] [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; SQL [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; constraint [PUBLIC.CONSTRAINT_INDEX_8]","timestamp":"2026-01-29T16:08:23.4459719","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:111) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:08:23.445+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: could not execute statement [Unique index or primary key violation: \"PUBLIC.CONSTRAINT_INDEX_8 ON PUBLIC.PAYMENTS(ORDER_ID NULLS FIRST) VALUES ( /* 8 */ CAST(8 AS BIGINT) )\"; SQL statement:\ninsert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default) [23505-232]] [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; SQL [insert into payments (card_last_four_digits,created_at,failure_reason,order_id,paid_amount,paid_customer_email,paid_customer_name,payment_method,payment_provider,processed_at,status,transaction_id,updated_at,version,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,default)]; constraint [PUBLIC.CONSTRAINT_INDEX_8]","timestamp":"2026-01-29T16:08:23.4459719","path":"/api/payments/prepare"}"
2026-01-29T16:08:23.454+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Aborting transaction - releasing all prepared resources
2026-01-29T16:08:23.454+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Aborting order: ID=8
2026-01-29T16:08:23.454+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/8/abort
2026-01-29T16:08:23.496+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 8
2026-01-29T16:08:23.503+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order aborted
2026-01-29T16:08:23.504+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed
2026-01-29T16:08:23.504+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=301 ms | success=false
2026-01-29T16:08:32.782+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:08:32.782+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:08:32.788+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:08:32.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 9
2026-01-29T16:08:32.908+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Order created with ID: 9
2026-01-29T16:08:32.909+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:08:32.925+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 9","timestamp":"2026-01-29T16:08:32.9199833","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 9","timestamp":"2026-01-29T16:08:32.9199833","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:08:32.929+01:00 ERROR 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 9","timestamp":"2026-01-29T16:08:32.9199833","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 9","timestamp":"2026-01-29T16:08:32.9199833","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: Payment already exists for order: 9","timestamp":"2026-01-29T16:08:32.9199833","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:08:32.929+01:00  WARN 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 9
2026-01-29T16:08:32.971+01:00  INFO 16232 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=189 ms | success=false
2026-01-29T16:11:46.178+01:00  INFO 16232 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T16:11:46.217+01:00  INFO 16232 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T16:11:46.327+01:00  INFO 16232 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T16:11:46.436+01:00  WARN 16232 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T16:11:46.436+01:00  INFO 16232 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T16:11:46.436+01:00  INFO 16232 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T16:11:58.156+01:00  INFO 7512 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 7512 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T16:11:58.158+01:00  INFO 7512 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T16:11:58.194+01:00  INFO 7512 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T16:11:58.195+01:00  INFO 7512 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T16:11:59.113+01:00  INFO 7512 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T16:11:59.124+01:00  INFO 7512 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11 ms. Found 0 JPA repository interfaces.
2026-01-29T16:11:59.739+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T16:11:59.758+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T16:11:59.759+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T16:11:59.824+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T16:11:59.826+01:00  INFO 7512 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1628 ms
2026-01-29T16:12:00.105+01:00  INFO 7512 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T16:12:00.286+01:00  INFO 7512 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T16:12:00.286+01:00  INFO 7512 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T16:12:00.322+01:00  INFO 7512 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T16:12:00.338+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T16:12:00.338+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.010s)
2026-01-29T16:12:00.353+01:00  INFO 7512 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T16:12:00.353+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T16:12:00.369+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T16:12:00.385+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T16:12:00.403+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T16:12:00.451+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T16:12:00.498+01:00  INFO 7512 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T16:12:00.545+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T16:12:00.799+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T16:12:00.902+01:00  INFO 7512 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T16:12:01.264+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T16:12:01.280+01:00  INFO 7512 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T16:12:01.401+01:00  WARN 7512 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T16:12:01.585+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T16:12:01.639+01:00  WARN 7512 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T16:12:01.717+01:00  INFO 7512 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T16:12:01.717+01:00  INFO 7512 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 3.985 seconds (process running for 4.348)
2026-01-29T16:12:05.222+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T16:12:05.222+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T16:12:05.232+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 10 ms
2026-01-29T16:12:05.607+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:12:05.608+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:12:05.612+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:12:05.833+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 10
2026-01-29T16:12:05.834+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 10
2026-01-29T16:12:05.840+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:12:05.894+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 30
2026-01-29T16:12:05.895+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Payment created with ID: 30 and transaction ID: TXN-b4d2e08f-a96d-4cd7-ade1-83e9419ba415
2026-01-29T16:12:05.898+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:12:06.005+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 29
2026-01-29T16:12:06.005+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Shipment created with ID: 29
2026-01-29T16:12:06.021+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 10
2026-01-29T16:12:06.021+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=417 ms | success=true
2026-01-29T16:12:10.233+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:12:10.233+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:12:10.249+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:12:10.249+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:12:10.430+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 11
2026-01-29T16:12:10.431+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=11, status=PREPARED, latency=182ms
2026-01-29T16:12:10.433+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:12:10.433+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:12:10.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 31
2026-01-29T16:12:10.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=31, status=PRE_AUTHORIZED, latency=70ms
2026-01-29T16:12:10.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:12:10.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:12:10.597+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 30
2026-01-29T16:12:10.599+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=30, status=RESERVED, latency=96ms
2026-01-29T16:12:10.602+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:12:10.603+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:12:10.604+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/11/commit
2026-01-29T16:12:10.644+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 11
2026-01-29T16:12:10.644+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=11, latency=41ms
2026-01-29T16:12:10.645+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:12:10.646+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/31/commit
2026-01-29T16:12:10.662+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 31
2026-01-29T16:12:10.662+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=31, latency=17ms
2026-01-29T16:12:10.663+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:12:10.663+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/30/commit
2026-01-29T16:12:10.679+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 30
2026-01-29T16:12:10.680+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=30, latency=17ms
2026-01-29T16:12:10.680+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:12:10.680+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=434 ms | success=true
2026-01-29T16:12:13.460+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:12:13.462+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:12:13.463+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:12:13.463+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:12:13.524+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare order: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:13.5071497\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:13.5161092","path":"/api/orders/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:13.5071497\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:13.5161092","path":"/api/orders/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareOrder(MicroserviceClient.java:110) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:100) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:12:13.537+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare order: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:13.5071497\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:13.5161092","path":"/api/orders/prepare"}"
2026-01-29T16:12:13.540+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Aborting transaction - releasing all prepared resources
2026-01-29T16:12:13.541+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed
2026-01-29T16:12:13.541+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=80 ms | success=false
2026-01-29T16:12:17.919+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:12:17.925+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:12:17.925+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:12:17.925+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:12:17.959+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare order: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:17.9513121\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:17.954208","path":"/api/orders/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:17.9513121\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:17.954208","path":"/api/orders/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareOrder(MicroserviceClient.java:110) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:100) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:12:17.963+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare order: 500  on POST request for "http://localhost:8082/api/orders/prepare": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:17.9513121\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:17.954208","path":"/api/orders/prepare"}"
2026-01-29T16:12:17.967+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Aborting transaction - releasing all prepared resources
2026-01-29T16:12:17.968+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed
2026-01-29T16:12:17.968+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=42 ms | success=false
2026-01-29T16:12:19.430+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:12:19.430+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:12:19.430+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:12:19.513+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Error creating order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:19.5053112\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:19.5115033","path":"/api/orders"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:19.5053112\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:19.5115033","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:12:19.519+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:19.5053112\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:19.5115033","path":"/api/orders"}"

java.lang.RuntimeException: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:19.5053112\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:19.5115033","path":"/api/orders"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:35) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:19.5053112\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:19.5115033","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:12:19.528+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=94 ms | success=false
2026-01-29T16:12:21.132+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:12:21.132+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:12:21.132+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:12:21.250+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Error creating order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:21.2421078\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:21.2421078","path":"/api/orders"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:21.2421078\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:21.2421078","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:12:21.250+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:21.2421078\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:21.2421078","path":"/api/orders"}"

java.lang.RuntimeException: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:21.2421078\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:21.2421078","path":"/api/orders"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:35) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 0\",\"timestamp\":\"2026-01-29T16:12:21.2421078\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:12:21.2421078","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:12:21.258+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=123 ms | success=false
2026-01-29T16:12:30.662+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:12:30.663+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:12:30.692+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:12:30.746+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:12:30.746+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:12:30.755+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:12:54.927+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:12:54.928+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:12:54.929+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:12:55.057+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 12
2026-01-29T16:12:55.057+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 12
2026-01-29T16:12:55.057+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:12:55.088+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 32
2026-01-29T16:12:55.088+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Payment created with ID: 32 and transaction ID: TXN-67f30a25-c6cc-43ff-b2e5-6e306e14c368
2026-01-29T16:12:55.089+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:12:55.119+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 31
2026-01-29T16:12:55.119+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Shipment created with ID: 31
2026-01-29T16:12:55.119+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 12
2026-01-29T16:12:55.124+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=195 ms | success=true
2026-01-29T16:12:57.654+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:12:57.654+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:12:57.654+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:12:57.654+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:12:57.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 13
2026-01-29T16:12:57.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=13, status=PREPARED, latency=108ms
2026-01-29T16:12:57.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:12:57.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:12:57.792+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 33
2026-01-29T16:12:57.793+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=33, status=PRE_AUTHORIZED, latency=31ms
2026-01-29T16:12:57.793+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:12:57.793+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:12:57.829+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 32
2026-01-29T16:12:57.829+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=32, status=RESERVED, latency=36ms
2026-01-29T16:12:57.829+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:12:57.829+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:12:57.829+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/13/commit
2026-01-29T16:12:57.846+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 13
2026-01-29T16:12:57.846+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=13, latency=17ms
2026-01-29T16:12:57.846+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:12:57.846+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/33/commit
2026-01-29T16:12:57.862+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 33
2026-01-29T16:12:57.862+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=33, latency=16ms
2026-01-29T16:12:57.862+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:12:57.862+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/32/commit
2026-01-29T16:12:57.880+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 32
2026-01-29T16:12:57.881+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=32, latency=19ms
2026-01-29T16:12:57.881+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:12:57.881+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=223 ms | success=true
2026-01-29T16:13:04.519+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:13:04.531+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:13:04.535+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:13:04.536+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:13:04.644+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 14
2026-01-29T16:13:04.645+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=14, status=PREPARED, latency=110ms
2026-01-29T16:13:04.646+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:13:04.647+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:13:04.675+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 34
2026-01-29T16:13:04.675+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=34, status=PRE_AUTHORIZED, latency=29ms
2026-01-29T16:13:04.675+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:13:04.675+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:13:04.708+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 33
2026-01-29T16:13:04.708+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=33, status=RESERVED, latency=33ms
2026-01-29T16:13:04.717+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:13:04.717+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:13:04.719+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/14/commit
2026-01-29T16:13:04.737+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 14
2026-01-29T16:13:04.738+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=14, latency=21ms
2026-01-29T16:13:04.738+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:13:04.738+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/34/commit
2026-01-29T16:13:04.752+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 34
2026-01-29T16:13:04.752+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=34, latency=14ms
2026-01-29T16:13:04.753+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:13:04.753+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/33/commit
2026-01-29T16:13:04.775+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 33
2026-01-29T16:13:04.775+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=33, latency=22ms
2026-01-29T16:13:04.775+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:13:04.775+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=248 ms | success=true
2026-01-29T16:13:06.926+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:13:06.927+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:13:06.928+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:13:07.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 15
2026-01-29T16:13:07.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Order created with ID: 15
2026-01-29T16:13:07.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:13:07.083+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 35
2026-01-29T16:13:07.084+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Payment created with ID: 35 and transaction ID: TXN-8e0f2a28-8396-4f3a-8990-c1290924b549
2026-01-29T16:13:07.085+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:13:07.109+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 34
2026-01-29T16:13:07.109+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Shipment created with ID: 34
2026-01-29T16:13:07.116+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 15
2026-01-29T16:13:07.117+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=189 ms | success=true
2026-01-29T16:13:57.487+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:13:57.489+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:13:57.530+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:13:57.554+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:13:57.554+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:13:57.570+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:02.145+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to false
2026-01-29T16:14:02.147+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: false
2026-01-29T16:14:02.228+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:02.228+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:02.234+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:04.719+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:14:04.722+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:14:04.729+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:14:04.855+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 16
2026-01-29T16:14:04.855+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Order created with ID: 16
2026-01-29T16:14:04.855+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:14:04.880+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:04.8805857","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:04.8805857","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:14:04.887+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:04.8805857","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:04.8805857","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:04.8805857","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:14:04.892+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 16
2026-01-29T16:14:04.925+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=202 ms | success=false
2026-01-29T16:14:14.716+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:14:14.718+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:14:14.722+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:14:14.723+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:14:14.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 17
2026-01-29T16:14:14.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=17, status=PREPARED, latency=113ms
2026-01-29T16:14:14.836+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:14:14.836+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:14:14.846+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:14.8458504","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:14.8458504","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:111) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:14:14.851+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:14.8458504","path":"/api/payments/prepare"}"
2026-01-29T16:14:14.853+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Aborting transaction - releasing all prepared resources
2026-01-29T16:14:14.853+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Aborting order: ID=17
2026-01-29T16:14:14.854+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/17/abort
2026-01-29T16:14:14.892+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 17
2026-01-29T16:14:14.893+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order aborted
2026-01-29T16:14:14.893+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed
2026-01-29T16:14:14.893+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=177 ms | success=false
2026-01-29T16:14:17.183+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:14:17.187+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:14:17.190+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:14:17.298+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 18
2026-01-29T16:14:17.298+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order created with ID: 18
2026-01-29T16:14:17.304+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:14:17.333+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:17.3313313","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:17.3313313","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:14:17.336+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:17.3313313","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:17.3313313","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:14:17.3313313","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:14:17.342+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 18
2026-01-29T16:14:17.387+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=200 ms | success=false
2026-01-29T16:14:17.899+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:17.899+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:17.908+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:17.914+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:17.914+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:17.921+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:18.722+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to true
2026-01-29T16:14:18.726+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: true
2026-01-29T16:14:18.750+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:18.751+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:18.757+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:20.400+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:14:20.400+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:14:20.401+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:14:20.512+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 19
2026-01-29T16:14:20.512+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Order created with ID: 19
2026-01-29T16:14:20.520+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:14:20.554+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 36
2026-01-29T16:14:20.554+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Payment created with ID: 36 and transaction ID: TXN-e1c72c90-4da4-4605-be88-ad97acab2bed
2026-01-29T16:14:20.554+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:14:20.585+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 35
2026-01-29T16:14:20.585+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Shipment created with ID: 35
2026-01-29T16:14:20.586+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 19
2026-01-29T16:14:20.587+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=189 ms | success=true
2026-01-29T16:14:21.634+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:21.634+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:21.634+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:14:21.652+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:14:21.652+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:14:21.660+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:15:08.411+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:15:08.411+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:15:08.421+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:15:08.438+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:15:08.438+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:15:08.444+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:25:50.023+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:25:50.029+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:25:50.037+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:25:50.155+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 20
2026-01-29T16:25:50.155+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order created with ID: 20
2026-01-29T16:25:50.155+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:25:50.178+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 37
2026-01-29T16:25:50.186+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Payment created with ID: 37 and transaction ID: TXN-f172a2bb-2535-4594-9356-b3df2bdcaf45
2026-01-29T16:25:50.186+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:25:50.211+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 36
2026-01-29T16:25:50.211+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Shipment created with ID: 36
2026-01-29T16:25:50.211+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 20
2026-01-29T16:25:50.211+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=188 ms | success=true
2026-01-29T16:25:59.091+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:25:59.092+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:25:59.094+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:25:59.095+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:25:59.220+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 21
2026-01-29T16:25:59.220+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=21, status=PREPARED, latency=126ms
2026-01-29T16:25:59.220+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:25:59.220+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:25:59.243+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 38
2026-01-29T16:25:59.243+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=38, status=PRE_AUTHORIZED, latency=23ms
2026-01-29T16:25:59.250+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:25:59.251+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:25:59.326+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 37
2026-01-29T16:25:59.326+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=37, status=RESERVED, latency=76ms
2026-01-29T16:25:59.326+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:25:59.326+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:25:59.326+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/21/commit
2026-01-29T16:25:59.379+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 21
2026-01-29T16:25:59.380+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=21, latency=54ms
2026-01-29T16:25:59.396+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:25:59.396+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/38/commit
2026-01-29T16:25:59.453+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 38
2026-01-29T16:25:59.453+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=38, latency=57ms
2026-01-29T16:25:59.454+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:25:59.454+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/37/commit
2026-01-29T16:25:59.499+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 37
2026-01-29T16:25:59.500+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=37, latency=46ms
2026-01-29T16:25:59.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:25:59.503+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=410 ms | success=true
2026-01-29T16:26:03.702+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:26:03.708+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:26:03.713+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:26:03.713+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:26:03.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 22
2026-01-29T16:26:03.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=22, status=PREPARED, latency=123ms
2026-01-29T16:26:03.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:26:03.835+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:26:03.853+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 39
2026-01-29T16:26:03.853+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=39, status=PRE_AUTHORIZED, latency=18ms
2026-01-29T16:26:03.853+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:26:03.853+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:26:03.886+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 38
2026-01-29T16:26:03.886+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=38, status=RESERVED, latency=33ms
2026-01-29T16:26:03.886+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:26:03.886+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:26:03.886+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/22/commit
2026-01-29T16:26:03.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 22
2026-01-29T16:26:03.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=22, latency=34ms
2026-01-29T16:26:03.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:26:03.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/39/commit
2026-01-29T16:26:03.941+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 39
2026-01-29T16:26:03.941+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=39, latency=21ms
2026-01-29T16:26:03.941+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:26:03.941+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/38/commit
2026-01-29T16:26:03.958+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 38
2026-01-29T16:26:03.958+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=38, latency=17ms
2026-01-29T16:26:03.958+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:26:03.958+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=263 ms | success=true
2026-01-29T16:26:05.689+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:26:05.689+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:26:05.694+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:26:05.804+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 23
2026-01-29T16:26:05.804+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order created with ID: 23
2026-01-29T16:26:05.804+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:26:05.836+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 40
2026-01-29T16:26:05.837+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Payment created with ID: 40 and transaction ID: TXN-ff0081a5-ab18-4f2b-9d6e-4df6ed792771
2026-01-29T16:26:05.838+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:26:05.867+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 39
2026-01-29T16:26:05.867+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Shipment created with ID: 39
2026-01-29T16:26:05.868+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 23
2026-01-29T16:26:05.868+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=176 ms | success=true
2026-01-29T16:26:14.792+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:26:14.810+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:26:14.812+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:26:14.812+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:26:14.961+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 24
2026-01-29T16:26:14.961+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=24, status=PREPARED, latency=149ms
2026-01-29T16:26:14.961+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:26:14.961+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:26:14.990+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 41
2026-01-29T16:26:14.990+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=41, status=PRE_AUTHORIZED, latency=29ms
2026-01-29T16:26:14.991+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:26:14.992+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:26:15.036+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 40
2026-01-29T16:26:15.036+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=40, status=RESERVED, latency=45ms
2026-01-29T16:26:15.036+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:26:15.036+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:26:15.036+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/24/commit
2026-01-29T16:26:15.053+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 24
2026-01-29T16:26:15.053+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=24, latency=17ms
2026-01-29T16:26:15.053+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:26:15.053+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/41/commit
2026-01-29T16:26:15.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 41
2026-01-29T16:26:15.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=41, latency=20ms
2026-01-29T16:26:15.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:26:15.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/40/commit
2026-01-29T16:26:15.090+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 40
2026-01-29T16:26:15.090+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=40, latency=17ms
2026-01-29T16:26:15.090+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:26:15.090+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=282 ms | success=true
2026-01-29T16:26:23.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:26:23.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:26:23.920+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:26:24.030+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 25
2026-01-29T16:26:24.030+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order created with ID: 25
2026-01-29T16:26:24.030+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:26:24.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 42
2026-01-29T16:26:24.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Payment created with ID: 42 and transaction ID: TXN-9d5dc1bc-4176-4370-b7f2-23d97d3d979b
2026-01-29T16:26:24.052+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:26:24.081+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 41
2026-01-29T16:26:24.081+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Shipment created with ID: 41
2026-01-29T16:26:24.083+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 25
2026-01-29T16:26:24.084+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=161 ms | success=true
2026-01-29T16:26:36.792+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:26:36.792+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:26:36.792+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:26:36.812+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:26:36.812+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:26:36.819+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:26:47.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier capacity to false
2026-01-29T16:26:47.762+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Setting carrier capacity to: false
2026-01-29T16:26:47.796+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:26:47.796+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:26:47.800+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:26:50.823+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:26:50.823+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:26:50.830+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:26:50.945+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 26
2026-01-29T16:26:50.946+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Order created with ID: 26
2026-01-29T16:26:50.946+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:26:50.975+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 43
2026-01-29T16:26:50.975+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Payment created with ID: 43 and transaction ID: TXN-eb68c10e-6a6a-4ec6-8f6a-74cae9d3a7cc
2026-01-29T16:26:50.979+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:26:51.022+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:26:51.0192883","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:26:51.0192883","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:26:51.025+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:26:51.0192883","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:26:51.0192883","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:26:51.0192883","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:26:51.030+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 43
2026-01-29T16:26:51.088+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 26
2026-01-29T16:26:51.120+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=292 ms | success=false
2026-01-29T16:27:10.103+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:27:10.103+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:27:10.103+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:27:10.103+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:27:10.210+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 27
2026-01-29T16:27:10.210+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=27, status=PREPARED, latency=107ms
2026-01-29T16:27:10.210+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:27:10.210+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:27:10.242+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 44
2026-01-29T16:27:10.242+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=44, status=PRE_AUTHORIZED, latency=32ms
2026-01-29T16:27:10.243+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:27:10.243+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:27:10.269+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:10.2611024","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:10.2611024","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:122) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:27:10.269+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:10.2611024","path":"/api/shipments/prepare"}"
2026-01-29T16:27:10.269+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Aborting transaction - releasing all prepared resources
2026-01-29T16:27:10.276+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Aborting payment: ID=44
2026-01-29T16:27:10.277+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/44/abort
2026-01-29T16:27:10.294+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 44
2026-01-29T16:27:10.302+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment aborted
2026-01-29T16:27:10.303+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Aborting order: ID=27
2026-01-29T16:27:10.303+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/27/abort
2026-01-29T16:27:10.336+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 27
2026-01-29T16:27:10.336+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order aborted
2026-01-29T16:27:10.336+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed
2026-01-29T16:27:10.336+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=233 ms | success=false
2026-01-29T16:27:15.971+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:27:15.973+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:27:15.973+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:27:16.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 28
2026-01-29T16:27:16.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Order created with ID: 28
2026-01-29T16:27:16.073+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:27:16.108+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 45
2026-01-29T16:27:16.108+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Payment created with ID: 45 and transaction ID: TXN-eb56a820-e03d-43b1-88b1-7f6a19a9b292
2026-01-29T16:27:16.108+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:27:16.138+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:16.1331889","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:16.1331889","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:27:16.139+01:00 ERROR 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:16.1331889","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:16.1331889","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:27:16.1331889","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:27:16.139+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 45
2026-01-29T16:27:16.165+01:00  WARN 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 28
2026-01-29T16:27:16.201+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=227 ms | success=false
2026-01-29T16:27:16.822+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:27:16.822+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:27:16.830+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:27:16.847+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:27:16.847+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:27:16.847+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:27:17.924+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier capacity to true
2026-01-29T16:27:17.924+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Setting carrier capacity to: true
2026-01-29T16:27:17.958+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:27:17.959+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:27:17.963+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:27:21.797+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:27:21.797+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:27:21.801+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:27:21.909+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 29
2026-01-29T16:27:21.909+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order created with ID: 29
2026-01-29T16:27:21.916+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:27:21.951+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 46
2026-01-29T16:27:21.952+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Payment created with ID: 46 and transaction ID: TXN-1d7cea15-1132-423a-947e-12a65507975c
2026-01-29T16:27:21.952+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:27:21.987+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 42
2026-01-29T16:27:21.987+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Shipment created with ID: 42
2026-01-29T16:27:21.987+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 29
2026-01-29T16:27:21.993+01:00  INFO 7512 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=194 ms | success=true
2026-01-29T16:34:16.107+01:00  INFO 7512 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T16:34:16.154+01:00  INFO 7512 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T16:34:16.264+01:00  INFO 7512 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T16:34:16.295+01:00  WARN 7512 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T16:34:16.295+01:00  INFO 7512 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T16:34:16.295+01:00  INFO 7512 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T16:34:29.002+01:00  INFO 14212 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 14212 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T16:34:29.006+01:00  INFO 14212 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T16:34:29.054+01:00  INFO 14212 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T16:34:29.055+01:00  INFO 14212 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T16:34:29.996+01:00  INFO 14212 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T16:34:30.030+01:00  INFO 14212 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 0 JPA repository interfaces.
2026-01-29T16:34:30.737+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T16:34:30.776+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T16:34:30.782+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T16:34:30.850+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T16:34:30.850+01:00  INFO 14212 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1791 ms
2026-01-29T16:34:31.268+01:00  INFO 14212 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T16:34:31.444+01:00  INFO 14212 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T16:34:31.445+01:00  INFO 14212 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T16:34:31.491+01:00  INFO 14212 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T16:34:31.540+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T16:34:31.544+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.027s)
2026-01-29T16:34:31.575+01:00  INFO 14212 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T16:34:31.578+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T16:34:31.646+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T16:34:31.667+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T16:34:31.684+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.007s)
2026-01-29T16:34:31.750+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T16:34:31.809+01:00  INFO 14212 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T16:34:31.843+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T16:34:32.046+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T16:34:32.111+01:00  INFO 14212 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T16:34:32.468+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T16:34:32.479+01:00  INFO 14212 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T16:34:32.593+01:00  WARN 14212 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T16:34:32.921+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T16:34:32.982+01:00  WARN 14212 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T16:34:33.063+01:00  INFO 14212 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T16:34:33.063+01:00  INFO 14212 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.611 seconds (process running for 5.006)
2026-01-29T16:34:34.887+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T16:34:34.888+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T16:34:34.888+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2026-01-29T16:34:35.104+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:34:35.104+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:34:35.117+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:34:35.311+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Error creating order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 1\",\"timestamp\":\"2026-01-29T16:34:35.290395\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:34:35.3035558","path":"/api/orders"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 1\",\"timestamp\":\"2026-01-29T16:34:35.290395\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:34:35.3035558","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:34:35.317+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 1\",\"timestamp\":\"2026-01-29T16:34:35.290395\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:34:35.3035558","path":"/api/orders"}"

java.lang.RuntimeException: Failed to create order: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 1\",\"timestamp\":\"2026-01-29T16:34:35.290395\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:34:35.3035558","path":"/api/orders"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:35) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createOrder(SagaService.java:156) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:41) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8082/api/orders": "{"status":500,"message":"An unexpected error occurred: 500  on POST request for \"http://localhost:8081/api/products/stock/reserve\": \"{\"status\":500,\"message\":\"An unexpected error occurred: Insufficient stock for product 1. Requested: 2, Available: 1\",\"timestamp\":\"2026-01-29T16:34:35.290395\",\"path\":\"/api/products/stock/reserve\"}\"","timestamp":"2026-01-29T16:34:35.3035558","path":"/api/orders"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createOrder(MicroserviceClient.java:30) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:34:35.321+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=212 ms | success=false
2026-01-29T16:35:00.356+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:35:00.357+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:35:00.357+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:35:00.472+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 30
2026-01-29T16:35:00.472+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 30
2026-01-29T16:35:00.472+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:35:00.530+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 47
2026-01-29T16:35:00.531+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Payment created with ID: 47 and transaction ID: TXN-a0f0598b-7b76-4b4a-8735-32898ee7fb41
2026-01-29T16:35:00.533+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:35:00.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 43
2026-01-29T16:35:00.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Shipment created with ID: 43
2026-01-29T16:35:00.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 30
2026-01-29T16:35:00.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=361 ms | success=true
2026-01-29T16:35:03.180+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:35:03.180+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:35:03.195+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:35:03.195+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:35:03.427+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 31
2026-01-29T16:35:03.427+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=31, status=PREPARED, latency=232ms
2026-01-29T16:35:03.427+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:35:03.427+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:35:03.456+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 48
2026-01-29T16:35:03.456+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=48, status=PRE_AUTHORIZED, latency=29ms
2026-01-29T16:35:03.457+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:35:03.457+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:35:03.500+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 44
2026-01-29T16:35:03.501+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=44, status=RESERVED, latency=44ms
2026-01-29T16:35:03.502+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:35:03.502+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:35:03.502+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/31/commit
2026-01-29T16:35:03.531+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 31
2026-01-29T16:35:03.533+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=31, latency=31ms
2026-01-29T16:35:03.535+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:35:03.536+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/48/commit
2026-01-29T16:35:03.549+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 48
2026-01-29T16:35:03.550+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=48, latency=15ms
2026-01-29T16:35:03.550+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:35:03.550+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/44/commit
2026-01-29T16:35:03.576+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 44
2026-01-29T16:35:03.576+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=44, latency=26ms
2026-01-29T16:35:03.577+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:35:03.577+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=385 ms | success=true
2026-01-29T16:35:05.505+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:35:05.512+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:35:05.513+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:35:05.513+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:35:05.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 32
2026-01-29T16:35:05.711+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=32, status=PREPARED, latency=198ms
2026-01-29T16:35:05.723+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:35:05.723+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:35:05.774+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 49
2026-01-29T16:35:05.775+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=49, status=PRE_AUTHORIZED, latency=52ms
2026-01-29T16:35:05.776+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:35:05.776+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:35:05.840+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 45
2026-01-29T16:35:05.841+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=45, status=RESERVED, latency=65ms
2026-01-29T16:35:05.842+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T16:35:05.842+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T16:35:05.843+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/32/commit
2026-01-29T16:35:05.874+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 32
2026-01-29T16:35:05.874+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=32, latency=32ms
2026-01-29T16:35:05.876+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T16:35:05.877+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/49/commit
2026-01-29T16:35:05.896+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 49
2026-01-29T16:35:05.898+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=49, latency=22ms
2026-01-29T16:35:05.900+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T16:35:05.900+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/45/commit
2026-01-29T16:35:05.920+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 45
2026-01-29T16:35:05.921+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=45, latency=22ms
2026-01-29T16:35:05.924+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T16:35:05.924+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=412 ms | success=true
2026-01-29T16:35:08.416+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:35:08.417+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:35:08.453+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:35:08.480+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:35:08.483+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:35:08.487+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:35:09.903+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to false
2026-01-29T16:35:09.903+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: false
2026-01-29T16:35:09.932+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:35:09.935+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:35:09.939+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:35:12.194+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:35:12.194+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:35:12.194+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:35:12.194+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:35:12.318+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 33
2026-01-29T16:35:12.318+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=33, status=PREPARED, latency=124ms
2026-01-29T16:35:12.318+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:35:12.318+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:35:12.336+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:12.3335314","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:12.3335314","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:106) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:35:12.339+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:12.3335314","path":"/api/payments/prepare"}"
2026-01-29T16:35:12.340+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/33/abort
2026-01-29T16:35:12.376+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 33
2026-01-29T16:35:12.376+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=185 ms | success=false
2026-01-29T16:35:16.252+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:35:16.252+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:35:16.252+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:35:16.371+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 34
2026-01-29T16:35:16.371+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 34
2026-01-29T16:35:16.371+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:35:16.386+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:16.386742","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:16.386742","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:35:16.386+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:16.386742","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:16.386742","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:35:16.386742","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:35:16.386+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 34
2026-01-29T16:35:16.471+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=226 ms | success=false
2026-01-29T16:37:23.360+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:23.361+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:23.369+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:23.391+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:23.392+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:23.395+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:24.545+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to true
2026-01-29T16:37:24.546+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: true
2026-01-29T16:37:24.566+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:24.566+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:24.571+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:25.835+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:37:25.835+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:37:25.835+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:37:25.945+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 35
2026-01-29T16:37:25.946+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Order created with ID: 35
2026-01-29T16:37:25.947+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:37:25.986+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 50
2026-01-29T16:37:25.986+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Payment created with ID: 50 and transaction ID: TXN-ea9265fd-865a-4fc5-9ae0-af969ab87eba
2026-01-29T16:37:25.986+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:37:26.019+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 46
2026-01-29T16:37:26.019+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Shipment created with ID: 46
2026-01-29T16:37:26.019+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 35
2026-01-29T16:37:26.019+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=183 ms | success=true
2026-01-29T16:37:26.859+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:26.859+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:26.859+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:26.859+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:26.859+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:26.883+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:27.486+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to false
2026-01-29T16:37:27.486+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: false
2026-01-29T16:37:27.518+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:37:27.533+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:37:27.563+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:37:29.322+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:37:29.322+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:37:29.326+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:37:29.486+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 36
2026-01-29T16:37:29.486+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 36
2026-01-29T16:37:29.486+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:37:29.528+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:29.5254327","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:29.5254327","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:37:29.535+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:29.5254327","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:29.5254327","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:29.5254327","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:37:29.535+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 36
2026-01-29T16:37:29.768+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=445 ms | success=false
2026-01-29T16:37:38.794+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:37:38.794+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:37:38.795+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:37:38.795+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:37:38.947+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 37
2026-01-29T16:37:38.947+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=37, status=PREPARED, latency=152ms
2026-01-29T16:37:38.947+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:37:38.947+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:37:38.960+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:38.9601523","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:38.9601523","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:106) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:37:38.964+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:38.9601523","path":"/api/payments/prepare"}"
2026-01-29T16:37:38.964+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/37/abort
2026-01-29T16:37:38.998+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 37
2026-01-29T16:37:38.998+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=209 ms | success=false
2026-01-29T16:37:45.129+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:37:45.131+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:37:45.131+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:37:45.132+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:37:45.243+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 38
2026-01-29T16:37:45.246+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=38, status=PREPARED, latency=115ms
2026-01-29T16:37:45.246+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:37:45.246+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:37:45.261+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:45.2619598","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:45.2619598","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:106) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:37:45.270+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:45.2619598","path":"/api/payments/prepare"}"
2026-01-29T16:37:45.270+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/38/abort
2026-01-29T16:37:45.387+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 38
2026-01-29T16:37:45.387+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=262 ms | success=false
2026-01-29T16:37:50.358+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:37:50.358+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:37:50.358+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:37:50.498+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 39
2026-01-29T16:37:50.498+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Order created with ID: 39
2026-01-29T16:37:50.498+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:37:50.526+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:50.515586","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:50.515586","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:37:50.526+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:50.515586","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:50.515586","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:37:50.515586","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:37:50.532+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 39
2026-01-29T16:37:50.573+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=217 ms | success=false
2026-01-29T16:40:11.871+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:11.871+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:11.879+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:11.895+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:11.897+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:11.897+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:13.226+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to false
2026-01-29T16:40:13.230+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: false
2026-01-29T16:40:13.273+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:13.274+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:13.282+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:15.196+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:40:15.196+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:40:15.196+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:40:15.320+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 40
2026-01-29T16:40:15.328+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 40
2026-01-29T16:40:15.329+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:40:15.371+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:15.362693","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:15.362693","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:15.371+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:15.362693","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:15.362693","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:15.362693","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:40:15.379+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 40
2026-01-29T16:40:15.404+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=206 ms | success=false
2026-01-29T16:40:17.026+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:40:17.030+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:40:17.031+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:40:17.031+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:40:17.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 41
2026-01-29T16:40:17.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=41, status=PREPARED, latency=126ms
2026-01-29T16:40:17.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:40:17.158+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:40:17.173+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:17.1691999","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:17.1691999","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:106) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:17.173+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T16:40:17.1691999","path":"/api/payments/prepare"}"
2026-01-29T16:40:17.173+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/41/abort
2026-01-29T16:40:17.211+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 41
2026-01-29T16:40:17.212+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=182 ms | success=false
2026-01-29T16:40:20.300+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:20.300+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:20.309+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:20.325+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:20.325+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:20.338+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:21.075+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to true
2026-01-29T16:40:21.075+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: true
2026-01-29T16:40:21.127+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:21.127+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:21.131+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:23.211+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:40:23.212+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:40:23.213+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:40:23.346+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 42
2026-01-29T16:40:23.346+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Order created with ID: 42
2026-01-29T16:40:23.346+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:40:23.455+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 51
2026-01-29T16:40:23.455+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Payment created with ID: 51 and transaction ID: TXN-ef3eb15d-90bf-4c00-a4f5-1bbebdb5abaa
2026-01-29T16:40:23.455+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:40:23.505+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:23.5052507","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:23.5052507","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:23.505+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:23.5052507","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:23.5052507","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:23.5052507","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:40:23.505+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 51
2026-01-29T16:40:23.556+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 42
2026-01-29T16:40:23.630+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=419 ms | success=false
2026-01-29T16:40:24.973+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:40:24.973+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:40:24.974+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:40:24.975+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:40:25.081+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 43
2026-01-29T16:40:25.081+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=43, status=PREPARED, latency=107ms
2026-01-29T16:40:25.082+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:40:25.082+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:40:25.118+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 52
2026-01-29T16:40:25.119+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=52, status=PRE_AUTHORIZED, latency=37ms
2026-01-29T16:40:25.119+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:40:25.119+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:40:25.136+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:25.1341586","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:25.1341586","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:117) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:25.139+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:25.1341586","path":"/api/shipments/prepare"}"
2026-01-29T16:40:25.139+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/52/abort
2026-01-29T16:40:25.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 52
2026-01-29T16:40:25.158+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/43/abort
2026-01-29T16:40:25.203+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 43
2026-01-29T16:40:25.203+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=229 ms | success=false
2026-01-29T16:40:26.627+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:26.627+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:26.636+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:26.648+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:26.649+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:26.653+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:28.174+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier capacity to false
2026-01-29T16:40:28.178+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Setting carrier capacity to: false
2026-01-29T16:40:28.205+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:28.205+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:28.207+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:31.586+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:40:31.586+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:40:31.586+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:40:31.708+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 44
2026-01-29T16:40:31.708+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Order created with ID: 44
2026-01-29T16:40:31.713+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:40:31.751+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 53
2026-01-29T16:40:31.751+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Payment created with ID: 53 and transaction ID: TXN-0b21831f-61ac-457f-b58d-8e0b86bdc24d
2026-01-29T16:40:31.751+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:40:31.784+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:31.7836725","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:31.7836725","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:31.793+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:31.7836725","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:31.7836725","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T16:40:31.7836725","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:40:31.797+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 53
2026-01-29T16:40:31.817+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 44
2026-01-29T16:40:31.853+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=266 ms | success=false
2026-01-29T16:40:33.594+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:33.594+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:33.606+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:33.609+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:33.615+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:33.618+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:34.402+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to true
2026-01-29T16:40:34.403+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: true
2026-01-29T16:40:34.459+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:40:34.460+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:40:34.479+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:40:36.454+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:40:36.454+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:40:36.456+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:40:36.548+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 45
2026-01-29T16:40:36.548+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Order created with ID: 45
2026-01-29T16:40:36.559+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:40:36.590+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 54
2026-01-29T16:40:36.590+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Payment created with ID: 54 and transaction ID: TXN-7d4cb556-0155-4144-b518-ec74fca38e59
2026-01-29T16:40:36.590+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:40:36.623+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:36.6180603","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:36.6180603","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:36.631+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:36.6180603","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:36.6180603","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:36.6180603","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:40:36.631+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 54
2026-01-29T16:40:36.648+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 45
2026-01-29T16:40:36.681+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=226 ms | success=false
2026-01-29T16:40:38.385+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T16:40:38.390+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T16:40:38.391+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T16:40:38.392+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T16:40:38.490+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 46
2026-01-29T16:40:38.490+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=46, status=PREPARED, latency=99ms
2026-01-29T16:40:38.490+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T16:40:38.490+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T16:40:38.524+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 55
2026-01-29T16:40:38.524+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=55, status=PRE_AUTHORIZED, latency=34ms
2026-01-29T16:40:38.524+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T16:40:38.524+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T16:40:38.550+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:38.5412269","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:38.5412269","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:117) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:38) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:38.554+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:38.5412269","path":"/api/shipments/prepare"}"
2026-01-29T16:40:38.554+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/55/abort
2026-01-29T16:40:38.575+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 55
2026-01-29T16:40:38.575+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/46/abort
2026-01-29T16:40:38.606+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 46
2026-01-29T16:40:38.608+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=216 ms | success=false
2026-01-29T16:40:39.061+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T16:40:39.061+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T16:40:39.061+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T16:40:39.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 47
2026-01-29T16:40:39.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Order created with ID: 47
2026-01-29T16:40:39.157+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T16:40:39.182+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 56
2026-01-29T16:40:39.190+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Payment created with ID: 56 and transaction ID: TXN-72ea298e-a88c-4657-bbd4-a0a729af9a3f
2026-01-29T16:40:39.190+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T16:40:39.217+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:39.2157359","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:39.2157359","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T16:40:39.217+01:00 ERROR 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:39.2157359","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:39.2157359","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T16:40:39.2157359","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T16:40:39.224+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 56
2026-01-29T16:40:39.241+01:00  WARN 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 47
2026-01-29T16:40:39.265+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=209 ms | success=false
2026-01-29T16:42:20.595+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:42:20.595+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:42:20.605+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:42:20.620+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:42:20.620+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:42:20.630+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:42:49.108+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:42:49.113+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:42:49.149+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T16:42:49.168+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T16:42:49.169+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T16:42:49.175+01:00  INFO 14212 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:09:31.179+01:00  INFO 14212 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T17:09:31.220+01:00  INFO 14212 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T17:09:31.322+01:00  INFO 14212 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:09:31.340+01:00  WARN 14212 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T17:09:31.340+01:00  INFO 14212 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T17:09:31.343+01:00  INFO 14212 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T17:09:44.486+01:00  INFO 2168 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 2168 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T17:09:44.489+01:00  INFO 2168 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T17:09:44.539+01:00  INFO 2168 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T17:09:44.540+01:00  INFO 2168 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T17:09:45.310+01:00  INFO 2168 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T17:09:45.365+01:00  INFO 2168 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 33 ms. Found 0 JPA repository interfaces.
2026-01-29T17:09:46.717+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T17:09:46.734+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T17:09:46.734+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T17:09:46.756+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T17:09:46.756+01:00  INFO 2168 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2216 ms
2026-01-29T17:09:46.936+01:00  INFO 2168 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T17:09:47.093+01:00  INFO 2168 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T17:09:47.093+01:00  INFO 2168 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T17:09:47.124+01:00  INFO 2168 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T17:09:47.155+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T17:09:47.155+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.012s)
2026-01-29T17:09:47.155+01:00  INFO 2168 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T17:09:47.155+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T17:09:47.191+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T17:09:47.198+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T17:09:47.202+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.005s)
2026-01-29T17:09:47.365+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T17:09:47.509+01:00  INFO 2168 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T17:09:47.572+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T17:09:47.806+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T17:09:47.862+01:00  INFO 2168 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T17:09:48.084+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T17:09:48.089+01:00  INFO 2168 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:09:48.209+01:00  WARN 2168 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T17:09:48.398+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T17:09:48.542+01:00  WARN 2168 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T17:09:48.748+01:00  INFO 2168 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T17:09:48.763+01:00  INFO 2168 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 4.659 seconds (process running for 5.36)
2026-01-29T17:09:54.054+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T17:09:54.054+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T17:09:54.054+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2026-01-29T17:09:54.307+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T17:09:54.308+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T17:09:54.311+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T17:09:55.066+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 48
2026-01-29T17:09:55.066+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 48
2026-01-29T17:09:55.067+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T17:09:55.367+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 57
2026-01-29T17:09:55.367+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Payment created with ID: 57 and transaction ID: TXN-67617ce9-9217-4742-b391-34d1b06014d4
2026-01-29T17:09:55.367+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T17:09:55.725+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T17:09:55.7044295","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T17:09:55.7044295","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:09:55.733+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T17:09:55.7044295","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T17:09:55.7044295","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable: Carrier at full capacity","timestamp":"2026-01-29T17:09:55.7044295","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T17:09:55.736+01:00  WARN 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 57
2026-01-29T17:09:55.760+01:00  WARN 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 48
2026-01-29T17:09:55.789+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=1483 ms | success=false
2026-01-29T17:09:58.224+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:09:58.224+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:09:58.249+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:09:58.273+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:09:58.273+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:09:58.280+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:09:59.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier capacity to true
2026-01-29T17:09:59.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Setting carrier capacity to: true
2026-01-29T17:09:59.282+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:09:59.282+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:09:59.282+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:10:00.961+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T17:10:00.961+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T17:10:00.962+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T17:10:01.097+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 49
2026-01-29T17:10:01.098+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Order created with ID: 49
2026-01-29T17:10:01.098+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T17:10:01.131+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 58
2026-01-29T17:10:01.131+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Payment created with ID: 58 and transaction ID: TXN-6a08c956-e4bf-4ce7-9b01-7bcd2a0bb50d
2026-01-29T17:10:01.131+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T17:10:01.214+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 47
2026-01-29T17:10:01.214+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Shipment created with ID: 47
2026-01-29T17:10:01.214+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 49
2026-01-29T17:10:01.214+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=258 ms | success=true
2026-01-29T17:10:01.989+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:10:01.989+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:10:02.001+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:10:02.001+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:10:02.186+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 50
2026-01-29T17:10:02.188+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=50, status=PREPARED, latency=187ms
2026-01-29T17:10:02.189+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:10:02.189+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:10:02.215+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 59
2026-01-29T17:10:02.215+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=59, status=PRE_AUTHORIZED, latency=26ms
2026-01-29T17:10:02.215+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:10:02.215+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:10:02.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 48
2026-01-29T17:10:02.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=48, status=RESERVED, latency=40ms
2026-01-29T17:10:02.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T17:10:02.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T17:10:02.255+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/50/commit
2026-01-29T17:10:02.274+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 50
2026-01-29T17:10:02.275+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=50, latency=20ms
2026-01-29T17:10:02.275+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T17:10:02.275+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/59/commit
2026-01-29T17:10:02.289+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 59
2026-01-29T17:10:02.289+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=59, latency=14ms
2026-01-29T17:10:02.289+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T17:10:02.289+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/48/commit
2026-01-29T17:10:02.315+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 48
2026-01-29T17:10:02.316+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=48, latency=27ms
2026-01-29T17:10:02.317+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T17:10:02.318+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=323 ms | success=true
2026-01-29T17:11:38.469+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:11:38.470+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:11:38.471+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:11:38.471+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:11:38.575+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 51
2026-01-29T17:11:38.575+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=51, status=PREPARED, latency=104ms
2026-01-29T17:11:38.575+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:11:38.575+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:11:38.669+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 60
2026-01-29T17:11:38.679+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=60, status=PRE_AUTHORIZED, latency=104ms
2026-01-29T17:11:38.680+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:11:38.680+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:11:38.773+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 49
2026-01-29T17:11:38.774+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=49, status=RESERVED, latency=94ms
2026-01-29T17:11:38.774+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T17:11:38.774+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T17:11:38.775+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/51/commit
2026-01-29T17:11:38.791+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 51
2026-01-29T17:11:38.792+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=51, latency=18ms
2026-01-29T17:11:38.792+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T17:11:38.792+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/60/commit
2026-01-29T17:11:38.805+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 60
2026-01-29T17:11:38.806+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=60, latency=14ms
2026-01-29T17:11:38.806+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T17:11:38.806+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/49/commit
2026-01-29T17:11:38.814+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 49
2026-01-29T17:11:38.814+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=49, latency=8ms
2026-01-29T17:11:38.814+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T17:11:38.814+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=352 ms | success=true
2026-01-29T17:11:45.771+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T17:11:45.773+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T17:11:45.774+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T17:11:45.892+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 52
2026-01-29T17:11:45.892+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 52
2026-01-29T17:11:45.892+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T17:11:45.934+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 61
2026-01-29T17:11:45.934+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Payment created with ID: 61 and transaction ID: TXN-8358aa86-8f52-44bd-b2a5-5e21af3cc2e1
2026-01-29T17:11:45.934+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T17:11:45.959+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Shipment created successfully with ID: 50
2026-01-29T17:11:45.959+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Shipment created with ID: 50
2026-01-29T17:11:45.959+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order placement completed successfully for order ID: 52
2026-01-29T17:11:45.959+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=190 ms | success=true
2026-01-29T17:11:51.054+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:11:51.057+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:11:51.058+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:11:51.058+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:11:51.174+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 53
2026-01-29T17:11:51.174+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=53, status=PREPARED, latency=116ms
2026-01-29T17:11:51.175+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:11:51.175+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:11:51.206+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 62
2026-01-29T17:11:51.206+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=62, status=PRE_AUTHORIZED, latency=31ms
2026-01-29T17:11:51.213+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:11:51.213+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:11:51.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 51
2026-01-29T17:11:51.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=51, status=RESERVED, latency=43ms
2026-01-29T17:11:51.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T17:11:51.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T17:11:51.256+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/53/commit
2026-01-29T17:11:51.277+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 53
2026-01-29T17:11:51.277+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=53, latency=21ms
2026-01-29T17:11:51.277+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T17:11:51.277+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/62/commit
2026-01-29T17:11:51.291+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 62
2026-01-29T17:11:51.291+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=62, latency=14ms
2026-01-29T17:11:51.292+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T17:11:51.292+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/51/commit
2026-01-29T17:11:51.306+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 51
2026-01-29T17:11:51.306+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=51, latency=14ms
2026-01-29T17:11:51.306+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T17:11:51.306+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=251 ms | success=true
2026-01-29T17:12:53.121+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:12:53.121+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:12:53.148+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:12:53.191+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:12:53.192+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:12:53.197+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:12:54.587+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to false
2026-01-29T17:12:54.588+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: false
2026-01-29T17:12:54.620+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:12:54.621+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:12:54.625+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:12:56.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:12:56.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:12:56.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:12:56.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:12:56.511+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 54
2026-01-29T17:12:56.511+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=54, status=PREPARED, latency=118ms
2026-01-29T17:12:56.511+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:12:56.511+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:12:56.536+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:12:56.5268446","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:12:56.5268446","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:124) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:37) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:12:56.539+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:12:56.5268446","path":"/api/payments/prepare"}"
2026-01-29T17:12:56.544+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/54/abort
2026-01-29T17:12:56.577+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 54
2026-01-29T17:12:56.577+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=184 ms | success=false
2026-01-29T17:13:06.723+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:13:06.723+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:13:06.723+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:13:06.723+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:13:06.843+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 55
2026-01-29T17:13:06.844+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=55, status=PREPARED, latency=121ms
2026-01-29T17:13:06.844+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:13:06.845+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:13:06.854+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:13:06.8523489","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:13:06.8523489","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:124) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:37) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:13:06.859+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:13:06.8523489","path":"/api/payments/prepare"}"
2026-01-29T17:13:06.861+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/55/abort
2026-01-29T17:13:06.905+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 55
2026-01-29T17:13:06.909+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=177 ms | success=false
2026-01-29T17:13:08.602+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:13:08.602+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:13:08.615+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:13:08.640+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:13:08.640+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:13:08.648+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:13:09.754+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to false
2026-01-29T17:13:09.756+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: false
2026-01-29T17:13:09.809+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:13:09.809+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:13:09.825+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:13:10.515+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to true
2026-01-29T17:13:10.516+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: true
2026-01-29T17:13:10.537+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:13:10.537+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:13:10.542+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:13:12.281+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:13:12.281+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:13:12.281+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:13:12.281+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:13:12.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 56
2026-01-29T17:13:12.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=56, status=PREPARED, latency=112ms
2026-01-29T17:13:12.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:13:12.393+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:13:12.441+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 63
2026-01-29T17:13:12.441+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=63, status=PRE_AUTHORIZED, latency=48ms
2026-01-29T17:13:12.441+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:13:12.441+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:13:12.472+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:13:12.4702976","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:13:12.4702976","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:135) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:37) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:13:12.476+01:00 ERROR 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:13:12.4702976","path":"/api/shipments/prepare"}"
2026-01-29T17:13:12.477+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/63/abort
2026-01-29T17:13:12.489+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 63
2026-01-29T17:13:12.489+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/56/abort
2026-01-29T17:13:12.522+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 56
2026-01-29T17:13:12.522+01:00  INFO 2168 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=252 ms | success=false
2026-01-29T17:15:27.486+01:00  INFO 2168 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T17:15:27.507+01:00  INFO 2168 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T17:15:27.514+01:00  INFO 2168 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:15:27.531+01:00  WARN 2168 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T17:15:27.532+01:00  INFO 2168 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T17:15:27.533+01:00  INFO 2168 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T17:15:37.698+01:00  INFO 13764 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 13764 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T17:15:37.698+01:00  INFO 13764 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T17:15:37.743+01:00  INFO 13764 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T17:15:37.744+01:00  INFO 13764 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T17:15:38.314+01:00  INFO 13764 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T17:15:38.332+01:00  INFO 13764 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 23 ms. Found 0 JPA repository interfaces.
2026-01-29T17:15:39.062+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T17:15:39.109+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T17:15:39.109+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T17:15:39.165+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T17:15:39.165+01:00  INFO 13764 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1421 ms
2026-01-29T17:15:39.344+01:00  INFO 13764 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T17:15:39.546+01:00  INFO 13764 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T17:15:39.546+01:00  INFO 13764 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T17:15:39.651+01:00  INFO 13764 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T17:15:39.746+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T17:15:39.746+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.044s)
2026-01-29T17:15:39.764+01:00  INFO 13764 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T17:15:39.765+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T17:15:39.787+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T17:15:39.787+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T17:15:39.814+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.006s)
2026-01-29T17:15:39.873+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T17:15:39.904+01:00  INFO 13764 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T17:15:39.954+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T17:15:40.155+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T17:15:40.312+01:00  INFO 13764 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T17:15:40.622+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T17:15:40.638+01:00  INFO 13764 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:15:41.657+01:00  WARN 13764 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T17:15:42.114+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T17:15:42.260+01:00  WARN 13764 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T17:15:42.403+01:00  INFO 13764 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T17:15:42.409+01:00  INFO 13764 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 5.035 seconds (process running for 5.511)
2026-01-29T17:15:46.210+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T17:15:46.211+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T17:15:46.213+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2026-01-29T17:15:46.360+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T17:15:46.360+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T17:15:46.360+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T17:15:46.497+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 57
2026-01-29T17:15:46.498+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Order created with ID: 57
2026-01-29T17:15:46.499+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T17:15:46.525+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Payment created successfully with ID: 64
2026-01-29T17:15:46.526+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Payment created with ID: 64 and transaction ID: TXN-dd9a6bd0-6e7f-4457-8760-33de3f3439cc
2026-01-29T17:15:46.527+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Creating shipment at: http://localhost:8083/api/shipments
2026-01-29T17:15:46.555+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Error creating shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:46.5509552","path":"/api/shipments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:46.5509552","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:15:46.562+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:46.5509552","path":"/api/shipments"}"

java.lang.RuntimeException: Failed to create shipment: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:46.5509552","path":"/api/shipments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:63) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createShipment(SagaService.java:179) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:55) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:46.5509552","path":"/api/shipments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createShipment(MicroserviceClient.java:58) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T17:15:46.565+01:00  WARN 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Compensating payment: refunding payment ID 64
2026-01-29T17:15:46.586+01:00  WARN 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 57
2026-01-29T17:15:46.610+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=244 ms | success=false
2026-01-29T17:15:49.291+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:15:49.305+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:15:49.307+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:15:49.308+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:15:49.409+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 58
2026-01-29T17:15:49.409+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=58, status=PREPARED, latency=103ms
2026-01-29T17:15:49.409+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:15:49.409+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:15:49.433+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 65
2026-01-29T17:15:49.433+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=65, status=PRE_AUTHORIZED, latency=24ms
2026-01-29T17:15:49.433+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:15:49.433+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:15:49.449+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:49.449855","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:49.449855","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:137) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:39) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:15:49.461+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:15:49.449855","path":"/api/shipments/prepare"}"
2026-01-29T17:15:49.461+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/65/abort
2026-01-29T17:15:49.482+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 65
2026-01-29T17:15:49.482+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/58/abort
2026-01-29T17:15:49.507+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 58
2026-01-29T17:15:49.507+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=209 ms | success=false
2026-01-29T17:15:55.695+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:15:55.696+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:15:55.708+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:15:55.722+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:15:55.722+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:15:55.731+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:16:01.729+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:16:01.729+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:16:01.737+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:16:01.745+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:16:01.745+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:16:01.745+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:16:02.460+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to false
2026-01-29T17:16:02.460+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: false
2026-01-29T17:16:02.477+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:16:02.477+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:16:02.486+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:16:03.239+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to true
2026-01-29T17:16:03.241+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: true
2026-01-29T17:16:03.272+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:16:03.273+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:16:03.277+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:16:05.164+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:16:05.164+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:16:05.168+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:16:05.168+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:16:05.269+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 59
2026-01-29T17:16:05.270+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=59, status=PREPARED, latency=106ms
2026-01-29T17:16:05.271+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:16:05.271+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:16:05.295+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:05.2942497","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:05.2942497","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:126) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:39) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:16:05.295+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:05.2942497","path":"/api/payments/prepare"}"
2026-01-29T17:16:05.295+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/59/abort
2026-01-29T17:16:05.322+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 59
2026-01-29T17:16:05.322+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=156 ms | success=false
2026-01-29T17:16:09.671+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received place order request for customer: john.doe@example.com
2026-01-29T17:16:09.671+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Starting order placement for customer: john.doe@example.com
2026-01-29T17:16:09.671+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating order at: http://localhost:8082/api/orders
2026-01-29T17:16:09.788+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Order created successfully with ID: 60
2026-01-29T17:16:09.788+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Order created with ID: 60
2026-01-29T17:16:09.788+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Creating payment at: http://localhost:8084/api/payments
2026-01-29T17:16:09.820+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Error creating payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:09.8044968","path":"/api/payments"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:09.8044968","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:16:09.820+01:00 ERROR 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.service.SagaService        : Error during order placement: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:09.8044968","path":"/api/payments"}"

java.lang.RuntimeException: Failed to create payment: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:09.8044968","path":"/api/payments"}"
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:49) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.createPayment(SagaService.java:169) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.SagaService.placeOrder(SagaService.java:48) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrder(GatewayController.java:35) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrder(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:16:09.8044968","path":"/api/payments"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.createPayment(MicroserviceClient.java:44) ~[classes/:na]
	... 64 common frames omitted

2026-01-29T17:16:09.820+01:00  WARN 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Compensating order: cancelling order ID 60
2026-01-29T17:16:09.835+01:00  INFO 13764 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | SAGA | totalDuration=176 ms | success=false
2026-01-29T17:18:37.124+01:00  INFO 13764 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T17:18:37.137+01:00  INFO 13764 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T17:18:37.159+01:00  INFO 13764 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:18:37.170+01:00  WARN 13764 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T17:18:37.170+01:00  INFO 13764 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T17:18:37.170+01:00  INFO 13764 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-29T17:19:57.236+01:00  INFO 14548 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Starting ApiGatewayApplication using Java 21.0.8 with PID 14548 (C:\DiplProj\ecommerce-microservices-project\gateway\target\classes started by K76 in C:\DiplProj\ecommerce-microservices-project\gateway)
2026-01-29T17:19:57.236+01:00  INFO 14548 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : No active profile set, falling back to 1 default profile: "default"
2026-01-29T17:19:57.274+01:00  INFO 14548 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2026-01-29T17:19:57.274+01:00  INFO 14548 --- [Api Gateway] [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2026-01-29T17:19:57.873+01:00  INFO 14548 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-29T17:19:57.902+01:00  INFO 14548 --- [Api Gateway] [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 12 ms. Found 0 JPA repository interfaces.
2026-01-29T17:19:59.240+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-29T17:19:59.247+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-29T17:19:59.247+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.48]
2026-01-29T17:19:59.309+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-29T17:19:59.313+01:00  INFO 14548 --- [Api Gateway] [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2038 ms
2026-01-29T17:19:59.922+01:00  INFO 14548 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-29T17:20:00.146+01:00  INFO 14548 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:metricsdb user=SA
2026-01-29T17:20:00.149+01:00  INFO 14548 --- [Api Gateway] [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-29T17:20:00.291+01:00  INFO 14548 --- [Api Gateway] [restartedMain] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:metricsdb (H2 2.3)
2026-01-29T17:20:00.391+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-29T17:20:00.401+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbValidate     : Successfully validated 1 migration (execution time 00:00.049s)
2026-01-29T17:20:00.417+01:00  INFO 14548 --- [Api Gateway] [restartedMain] org.flywaydb.core.Flyway                 : All configured schemas are empty; baseline operation skipped. A baseline or migration script with a lower version than the baseline version may execute if available. Check the Schemas parameter if this is not intended.
2026-01-29T17:20:00.426+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-29T17:20:00.515+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-29T17:20:00.534+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create metrics tables"
2026-01-29T17:20:00.574+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.f.core.internal.command.DbMigrate      : Successfully applied 1 migration to schema "PUBLIC", now at version v1 (execution time 00:00.016s)
2026-01-29T17:20:00.708+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-29T17:20:00.782+01:00  INFO 14548 --- [Api Gateway] [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.33.Final
2026-01-29T17:20:00.847+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-29T17:20:01.159+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-29T17:20:01.234+01:00  INFO 14548 --- [Api Gateway] [restartedMain] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-29T17:20:01.487+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-29T17:20:01.491+01:00  INFO 14548 --- [Api Gateway] [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:20:01.616+01:00  WARN 14548 --- [Api Gateway] [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-29T17:20:01.811+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:metricsdb'
2026-01-29T17:20:01.873+01:00  WARN 14548 --- [Api Gateway] [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : Unable to start LiveReload server
2026-01-29T17:20:01.948+01:00  INFO 14548 --- [Api Gateway] [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-29T17:20:01.957+01:00  INFO 14548 --- [Api Gateway] [restartedMain] h.f.e.gateway.ApiGatewayApplication      : Started ApiGatewayApplication in 5.207 seconds (process running for 5.546)
2026-01-29T17:20:02.279+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-29T17:20:02.280+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-29T17:20:02.281+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2026-01-29T17:20:02.349+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:20:02.349+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:20:02.391+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:20:02.416+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:20:02.416+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:20:02.416+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:20:05.892+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:20:05.892+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:20:05.892+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:20:05.892+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:20:05.997+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 61
2026-01-29T17:20:05.998+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=61, status=PREPARED, latency=106ms
2026-01-29T17:20:05.998+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:20:06.000+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:20:06.017+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:20:06.0127413","path":"/api/payments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:20:06.0127413","path":"/api/payments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.preparePayment(MicroserviceClient.java:150) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:128) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:39) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:20:06.024+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare payment: 500  on POST request for "http://localhost:8084/api/payments/prepare": "{"status":500,"message":"An unexpected error occurred: FINA service is currently unavailable","timestamp":"2026-01-29T17:20:06.0127413","path":"/api/payments/prepare"}"
2026-01-29T17:20:06.026+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/61/abort
2026-01-29T17:20:06.052+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 61
2026-01-29T17:20:06.053+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed in 27 ms with 1 compensations
2026-01-29T17:20:06.055+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=158 ms | success=false
2026-01-29T17:20:12.437+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:20:12.437+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:20:12.437+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:20:12.463+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:20:12.463+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:20:12.463+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:20:13.315+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.ConfigController      : Gateway: Setting FINA availability to true
2026-01-29T17:20:13.316+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : Setting FINA availability to: true
2026-01-29T17:20:13.335+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:20:13.335+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:20:13.339+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:20:14.789+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:20:14.789+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:20:14.794+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:20:14.794+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:20:14.906+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 62
2026-01-29T17:20:14.906+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=62, status=PREPARED, latency=112ms
2026-01-29T17:20:14.907+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:20:14.907+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:20:14.966+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 66
2026-01-29T17:20:14.966+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=66, status=PRE_AUTHORIZED, latency=59ms
2026-01-29T17:20:14.966+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:20:14.969+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:20:15.054+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 52
2026-01-29T17:20:15.054+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=52, status=RESERVED, latency=88ms
2026-01-29T17:20:15.074+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T17:20:15.087+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T17:20:15.091+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/62/commit
2026-01-29T17:20:15.126+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 62
2026-01-29T17:20:15.131+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=62, latency=44ms
2026-01-29T17:20:15.132+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T17:20:15.145+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/66/commit
2026-01-29T17:20:15.203+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 66
2026-01-29T17:20:15.203+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=66, latency=71ms
2026-01-29T17:20:15.203+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T17:20:15.203+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/52/commit
2026-01-29T17:20:15.261+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 52
2026-01-29T17:20:15.261+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=52, latency=58ms
2026-01-29T17:20:15.262+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T17:20:15.262+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-1] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=469 ms | success=true
2026-01-29T17:22:54.868+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:22:54.871+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:22:54.893+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:22:54.933+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:22:54.938+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:22:54.951+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:22:55.614+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to false
2026-01-29T17:22:55.636+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-5] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: false
2026-01-29T17:22:55.700+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:22:55.700+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:22:55.713+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-6] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:22:57.132+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:22:57.133+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:22:57.136+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:22:57.136+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:22:57.288+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 63
2026-01-29T17:22:57.289+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=63, status=PREPARED, latency=153ms
2026-01-29T17:22:57.291+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:22:57.291+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:22:57.373+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 67
2026-01-29T17:22:57.374+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=67, status=PRE_AUTHORIZED, latency=83ms
2026-01-29T17:22:57.376+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:22:57.377+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:22:57.459+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:22:57.4487123","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:22:57.4487123","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:139) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:39) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:22:57.466+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:22:57.4487123","path":"/api/shipments/prepare"}"
2026-01-29T17:22:57.468+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/67/abort
2026-01-29T17:22:57.495+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 67
2026-01-29T17:22:57.495+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/63/abort
2026-01-29T17:22:57.573+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 63
2026-01-29T17:22:57.573+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed in 105 ms with 2 compensations
2026-01-29T17:22:57.574+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-7] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=441 ms | success=false
2026-01-29T17:23:26.988+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:23:26.988+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:23:26.988+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:23:26.988+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:23:27.176+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 64
2026-01-29T17:23:27.177+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=64, status=PREPARED, latency=189ms
2026-01-29T17:23:27.177+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:23:27.177+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:23:27.208+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 68
2026-01-29T17:23:27.208+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=68, status=PRE_AUTHORIZED, latency=31ms
2026-01-29T17:23:27.208+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:23:27.208+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:23:27.224+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:23:27.224798","path":"/api/shipments/prepare"}"

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:23:27.224798","path":"/api/shipments/prepare"}"
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:102) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:189) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518) ~[spring-web-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.client.MicroserviceClient.prepareShipment(MicroserviceClient.java:190) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.preparePhase(TwoPhaseCommitService.java:139) ~[classes/:na]
	at hr.fer.ecommerce.gateway.service.TwoPhaseCommitService.placeOrderWith2PC(TwoPhaseCommitService.java:39) ~[classes/:na]
	at hr.fer.ecommerce.gateway.controller.GatewayController.placeOrderWith2PC(GatewayController.java:57) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.validation.beanvalidation.MethodValidationInterceptor.invoke(MethodValidationInterceptor.java:172) ~[spring-context-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.12.jar:6.2.12]
	at hr.fer.ecommerce.gateway.controller.GatewayController$$SpringCGLIB$$0.placeOrderWith2PC(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]

2026-01-29T17:23:27.224+01:00 ERROR 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase failed: Failed to prepare shipment: 500  on POST request for "http://localhost:8083/api/shipments/prepare": "{"status":500,"message":"An unexpected error occurred: Carrier 'GLS' is currently unavailable","timestamp":"2026-01-29T17:23:27.224798","path":"/api/shipments/prepare"}"
2026-01-29T17:23:27.240+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting payment at: http://localhost:8084/api/payments/68/abort
2026-01-29T17:23:27.259+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment aborted - ID: 68
2026-01-29T17:23:27.259+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Aborting order at: http://localhost:8082/api/orders/64/abort
2026-01-29T17:23:27.291+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order aborted - ID: 64
2026-01-29T17:23:27.291+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.service.TwoPhaseCommitService    : Abort phase completed in 51 ms with 2 compensations
2026-01-29T17:23:27.291+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-8] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=310 ms | success=false
2026-01-29T17:23:28.319+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:23:28.319+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:23:28.326+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-9] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:23:28.332+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:23:28.340+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:23:28.345+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-10] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:23:29.486+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.g.controller.ConfigController      : Gateway: Setting carrier availability to true
2026-01-29T17:23:29.486+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-2] h.f.e.gateway.client.MicroserviceClient  : Setting carrier availability to: true
2026-01-29T17:23:29.500+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.g.controller.ConfigController      : Gateway: Getting all configuration status
2026-01-29T17:23:29.501+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting FINA status
2026-01-29T17:23:29.511+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-4] h.f.e.gateway.client.MicroserviceClient  : Getting carrier status
2026-01-29T17:23:30.640+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : Received 2PC place order request for customer: john.doe@example.com
2026-01-29T17:23:30.640+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Starting 2PC for customer: john.doe@example.com
2026-01-29T17:23:30.648+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Preparing order and reserving stock
2026-01-29T17:23:30.649+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing order at: http://localhost:8082/api/orders/prepare
2026-01-29T17:23:30.748+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order prepared with ID: 65
2026-01-29T17:23:30.748+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Order prepared: ID=65, status=PREPARED, latency=100ms
2026-01-29T17:23:30.748+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Pre-authorizing payment
2026-01-29T17:23:30.748+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing payment at: http://localhost:8084/api/payments/prepare
2026-01-29T17:23:30.787+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment prepared with ID: 69
2026-01-29T17:23:30.787+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Payment prepared: ID=69, status=PRE_AUTHORIZED, latency=39ms
2026-01-29T17:23:30.787+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Reserving shipment capacity
2026-01-29T17:23:30.788+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Preparing shipment at: http://localhost:8083/api/shipments/prepare
2026-01-29T17:23:30.823+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment prepared with ID: 53
2026-01-29T17:23:30.823+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Shipment prepared: ID=53, status=RESERVED, latency=36ms
2026-01-29T17:23:30.823+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Prepare phase completed - all resources reserved
2026-01-29T17:23:30.823+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Committing order
2026-01-29T17:23:30.831+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing order at: http://localhost:8082/api/orders/65/commit
2026-01-29T17:23:30.848+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Order committed - ID: 65
2026-01-29T17:23:30.848+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Order committed: ID=65, latency=25ms
2026-01-29T17:23:30.848+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Committing payment
2026-01-29T17:23:30.848+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing payment at: http://localhost:8084/api/payments/69/commit
2026-01-29T17:23:30.865+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Payment committed - ID: 69
2026-01-29T17:23:30.865+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Payment committed: ID=69, latency=17ms
2026-01-29T17:23:30.865+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Committing shipment
2026-01-29T17:23:30.865+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Committing shipment at: http://localhost:8083/api/shipments/53/commit
2026-01-29T17:23:30.898+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.gateway.client.MicroserviceClient  : 2PC: Shipment committed - ID: 53
2026-01-29T17:23:30.899+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Shipment committed: ID=53, latency=34ms
2026-01-29T17:23:30.900+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.service.TwoPhaseCommitService    : Commit phase completed
2026-01-29T17:23:30.900+01:00  INFO 14548 --- [Api Gateway] [http-nio-8080-exec-3] h.f.e.g.controller.GatewayController     : GATEWAY | 2PC | totalDuration=253 ms | success=true
2026-01-29T17:24:56.420+01:00  INFO 14548 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2026-01-29T17:24:56.434+01:00  INFO 14548 --- [Api Gateway] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2026-01-29T17:24:56.454+01:00  INFO 14548 --- [Api Gateway] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-29T17:24:56.460+01:00  WARN 14548 --- [Api Gateway] [SpringApplicationShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2026-01-29T17:24:56.460+01:00  INFO 14548 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-29T17:24:56.463+01:00  INFO 14548 --- [Api Gateway] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
